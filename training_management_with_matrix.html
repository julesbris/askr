<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Training Management System - Cook Shire Council</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        .badge-internal { background: #10b981; color: white; }
        .badge-external { background: #8b5cf6; color: white; }
        .status-complete { background: #22c55e; color: white; }
        .status-expiring { background: #f59e0b; color: white; }
        .status-expired { background: #ef4444; color: white; }
        .status-pending { background: #94a3b8; color: white; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        const INITIAL_PEOPLE = [
            { id: 'p1', name: 'John Smith', roleId: 'role_1', department: 'Fleet & Civil Works', email: 'john.smith@cookshire.qld.gov.au' },
            { id: 'p2', name: 'Sarah Johnson', roleId: 'role_2', department: 'Fleet & Civil Works', email: 'sarah.johnson@cookshire.qld.gov.au' },
            { id: 'p3', name: 'Michael Brown', roleId: 'role_14', department: 'Engineering', email: 'michael.brown@cookshire.qld.gov.au' },
            { id: 'p4', name: 'Emily Davis', roleId: 'role_26', department: 'Water & Waste', email: 'emily.davis@cookshire.qld.gov.au' },
            { id: 'p5', name: 'David Wilson', roleId: 'role_47', department: 'Financial Services', email: 'david.wilson@cookshire.qld.gov.au' },
        ];

        const INITIAL_COURSES = [
            { id: 'course_1', name: 'White Card - Construction Induction', providerType: 'external', provider: 'SafeWork QLD', recertificationMonths: null, internalVerificationAllowed: false, cost: 120, duration: '1 day', notes: 'Required for all construction workers' },
            { id: 'course_2', name: 'First Aid Certificate', providerType: 'external', provider: 'St Johns Ambulance', recertificationMonths: 36, internalVerificationAllowed: false, cost: 180, duration: '2 days', notes: 'CPR and First Aid training' },
            { id: 'course_3', name: 'Forklift Operation', providerType: 'internal', provider: 'Cook Shire Council', recertificationMonths: 60, internalVerificationAllowed: true, internalVerifier: 'Workshop Foreman', cost: 0, duration: '3 days', notes: 'Internal training with certification' },
            { id: 'course_4', name: 'Manual Handling', providerType: 'internal', provider: 'Cook Shire Council', recertificationMonths: 24, internalVerificationAllowed: true, internalVerifier: 'WHS Manager', cost: 0, duration: '4 hours', notes: 'Refresher every 2 years' },
        ];

        const INITIAL_ROLES = [
            { id: 'role_1', name: 'Depot Administration Officer', department: 'Fleet & Civil Works' },
            { id: 'role_2', name: 'Diesel Fitter', department: 'Fleet & Civil Works' },
            { id: 'role_14', name: 'Concrete Finisher', department: 'Engineering' },
            { id: 'role_26', name: 'Botanic Gardens Curator', department: 'Parks & Gardens' },
            { id: 'role_47', name: 'Cooktown Airport Operations Officer', department: 'Airports' },
        ];

        const INITIAL_COMPETENCIES = [
            { id: 'comp_1', name: 'Working with Children check (Blue Card)', category: 'Compliance' },
            { id: 'comp_3', name: 'White Card - Construction Induction', category: 'Safety' },
            { id: 'comp_4', name: 'Car Licence (C)', category: 'Vehicle Licence' },
            { id: 'comp_207', name: 'Emergency Procedures', category: 'Safety' },
            { id: 'comp_208', name: 'Information Privacy', category: 'Compliance' },
        ];

        const INITIAL_REQUIREMENTS = {
            'comp_3': { 'role_2': 'M(A)', 'role_14': 'M(A)' },
            'comp_4': { 'role_1': 'M(A)', 'role_2': 'M(A)', 'role_14': 'M(A)', 'role_47': 'M(A)' },
            'comp_207': { 'role_1': 'M(A)', 'role_2': 'M(A)', 'role_14': 'M(A)', 'role_26': 'M(A)', 'role_47': 'M(A)' },
        };

        function Modal({ isOpen, onClose, title, children, size = 'md' }) {
            if (!isOpen) return null;
            const sizeClasses = { 'sm': 'max-w-md', 'md': 'max-w-2xl', 'lg': 'max-w-4xl', 'xl': 'max-w-6xl' };
            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" onClick={onClose}>
                    <div className={`bg-white rounded-lg shadow-xl p-6 ${sizeClasses[size]} w-full max-h-[90vh] overflow-y-auto`} onClick={(e) => e.stopPropagation()}>
                        <div className="flex justify-between items-center mb-4">
                            <h3 className="text-xl font-bold">{title}</h3>
                            <button onClick={onClose} className="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                        </div>
                        {children}
                    </div>
                </div>
            );
        }

        function RequirementModal({ isOpen, onClose, onSave, competency, role, currentRequirement }) {
            const [requirement, setRequirement] = useState(currentRequirement || '');

            useEffect(() => {
                setRequirement(currentRequirement || '');
            }, [currentRequirement, isOpen]);

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave(competency.id, role.id, requirement);
                onClose();
            };

            return (
                <Modal isOpen={isOpen} onClose={onClose} title="Edit Requirement" size="sm">
                    <div className="mb-4 text-sm">
                        <p><strong>Competency:</strong> {competency?.name}</p>
                        <p><strong>Role:</strong> {role?.name}</p>
                    </div>
                    <form onSubmit={handleSubmit} className="space-y-4">
                        <div>
                            <label className="block text-sm font-medium mb-2">Requirement Level</label>
                            <select className="w-full px-3 py-2 border rounded-lg" value={requirement} onChange={(e) => setRequirement(e.target.value)}>
                                <option value="">None</option>
                                <option value="M(A)">M(A) - Mandatory (All)</option>
                                <option value="M(S)">M(S) - Mandatory (Specific)</option>
                                <option value="D(A)">D(A) - Desirable (All)</option>
                                <option value="D(S)">D(S) - Desirable (Specific)</option>
                            </select>
                        </div>
                        <div className="flex gap-3">
                            <button type="submit" className="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">Save</button>
                            <button type="button" onClick={onClose} className="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
                        </div>
                    </form>
                </Modal>
            );
        }

        function RoleModal({ isOpen, onClose, onSave, existingRole }) {
            const [formData, setFormData] = useState({ name: '', department: '' });

            useEffect(() => {
                if (existingRole) {
                    setFormData(existingRole);
                } else {
                    setFormData({ name: '', department: '' });
                }
            }, [existingRole, isOpen]);

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave({ ...formData, id: existingRole?.id || 'role_' + Date.now() });
                onClose();
            };

            return (
                <Modal isOpen={isOpen} onClose={onClose} title={existingRole ? 'Edit Role' : 'Add Role'} size="md">
                    <form onSubmit={handleSubmit} className="space-y-4">
                        <div>
                            <label className="block text-sm font-medium mb-1">Role Name *</label>
                            <input type="text" required className="w-full px-3 py-2 border rounded-lg" value={formData.name} onChange={(e) => setFormData({...formData, name: e.target.value})} />
                        </div>
                        <div>
                            <label className="block text-sm font-medium mb-1">Department</label>
                            <input type="text" className="w-full px-3 py-2 border rounded-lg" value={formData.department} onChange={(e) => setFormData({...formData, department: e.target.value})} />
                        </div>
                        <div className="flex gap-3">
                            <button type="submit" className="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">{existingRole ? 'Update' : 'Add'} Role</button>
                            <button type="button" onClick={onClose} className="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
                        </div>
                    </form>
                </Modal>
            );
        }

        function CompetencyModal({ isOpen, onClose, onSave, existingCompetency }) {
            const [formData, setFormData] = useState({ name: '', category: '' });

            useEffect(() => {
                if (existingCompetency) {
                    setFormData(existingCompetency);
                } else {
                    setFormData({ name: '', category: '' });
                }
            }, [existingCompetency, isOpen]);

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave({ ...formData, id: existingCompetency?.id || 'comp_' + Date.now() });
                onClose();
            };

            return (
                <Modal isOpen={isOpen} onClose={onClose} title={existingCompetency ? 'Edit Competency' : 'Add Competency'} size="md">
                    <form onSubmit={handleSubmit} className="space-y-4">
                        <div>
                            <label className="block text-sm font-medium mb-1">Competency Name *</label>
                            <input type="text" required className="w-full px-3 py-2 border rounded-lg" value={formData.name} onChange={(e) => setFormData({...formData, name: e.target.value})} />
                        </div>
                        <div>
                            <label className="block text-sm font-medium mb-1">Category</label>
                            <input type="text" className="w-full px-3 py-2 border rounded-lg" value={formData.category} onChange={(e) => setFormData({...formData, category: e.target.value})} />
                        </div>
                        <div className="flex gap-3">
                            <button type="submit" className="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">{existingCompetency ? 'Update' : 'Add'} Competency</button>
                            <button type="button" onClick={onClose} className="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
                        </div>
                    </form>
                </Modal>
            );
        }

        function CourseModal({ isOpen, onClose, onSave, existingCourse }) {
            const [formData, setFormData] = useState({ name: '', providerType: 'external', provider: '', recertificationMonths: '', internalVerificationAllowed: false, internalVerifier: '', cost: '', duration: '', notes: '' });

            useEffect(() => {
                if (existingCourse) {
                    setFormData(existingCourse);
                } else {
                    setFormData({ name: '', providerType: 'external', provider: '', recertificationMonths: '', internalVerificationAllowed: false, internalVerifier: '', cost: '', duration: '', notes: '' });
                }
            }, [existingCourse, isOpen]);

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave({
                    ...formData,
                    id: existingCourse?.id || 'course_' + Date.now(),
                    recertificationMonths: formData.recertificationMonths ? parseInt(formData.recertificationMonths) : null,
                    cost: formData.cost ? parseFloat(formData.cost) : 0
                });
                onClose();
            };

            return (
                <Modal isOpen={isOpen} onClose={onClose} title={existingCourse ? 'Edit Course' : 'Add New Course'} size="lg">
                    <form onSubmit={handleSubmit} className="space-y-4">
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="md:col-span-2">
                                <label className="block text-sm font-medium mb-1">Course Name *</label>
                                <input type="text" required className="w-full px-3 py-2 border rounded-lg" value={formData.name} onChange={(e) => setFormData({...formData, name: e.target.value})} />
                            </div>
                            <div>
                                <label className="block text-sm font-medium mb-1">Provider Type *</label>
                                <select required className="w-full px-3 py-2 border rounded-lg" value={formData.providerType} onChange={(e) => setFormData({...formData, providerType: e.target.value})}>
                                    <option value="internal">Internal</option>
                                    <option value="external">External</option>
                                </select>
                            </div>
                            <div>
                                <label className="block text-sm font-medium mb-1">Provider Name *</label>
                                <input type="text" required className="w-full px-3 py-2 border rounded-lg" value={formData.provider} onChange={(e) => setFormData({...formData, provider: e.target.value})} />
                            </div>
                            <div>
                                <label className="block text-sm font-medium mb-1">Recertification (months)</label>
                                <input type="number" min="1" className="w-full px-3 py-2 border rounded-lg" value={formData.recertificationMonths} onChange={(e) => setFormData({...formData, recertificationMonths: e.target.value})} />
                            </div>
                            <div>
                                <label className="block text-sm font-medium mb-1">Duration</label>
                                <input type="text" className="w-full px-3 py-2 border rounded-lg" value={formData.duration} onChange={(e) => setFormData({...formData, duration: e.target.value})} />
                            </div>
                            <div>
                                <label className="block text-sm font-medium mb-1">Cost ($)</label>
                                <input type="number" min="0" step="0.01" className="w-full px-3 py-2 border rounded-lg" value={formData.cost} onChange={(e) => setFormData({...formData, cost: e.target.value})} />
                            </div>
                            <div className="md:col-span-2">
                                <label className="flex items-center gap-2">
                                    <input type="checkbox" className="w-4 h-4" checked={formData.internalVerificationAllowed} onChange={(e) => setFormData({...formData, internalVerificationAllowed: e.target.checked})} />
                                    <span className="text-sm font-medium">Allow Internal Verification</span>
                                </label>
                            </div>
                            {formData.internalVerificationAllowed && (
                                <div className="md:col-span-2">
                                    <label className="block text-sm font-medium mb-1">Internal Verifier Role</label>
                                    <input type="text" className="w-full px-3 py-2 border rounded-lg" value={formData.internalVerifier} onChange={(e) => setFormData({...formData, internalVerifier: e.target.value})} />
                                </div>
                            )}
                            <div className="md:col-span-2">
                                <label className="block text-sm font-medium mb-1">Notes</label>
                                <textarea className="w-full px-3 py-2 border rounded-lg" rows="3" value={formData.notes} onChange={(e) => setFormData({...formData, notes: e.target.value})} />
                            </div>
                        </div>
                        <div className="flex gap-3">
                            <button type="submit" className="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">{existingCourse ? 'Update' : 'Add'} Course</button>
                            <button type="button" onClick={onClose} className="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
                        </div>
                    </form>
                </Modal>
            );
        }

        function TrainingRecordModal({ isOpen, onClose, onSave, person, competency, existingRecord, courses }) {
            const [formData, setFormData] = useState({ courseId: '', completedDate: '', expiryDate: '', provider: '', notes: '', certificateNumber: '', verifiedBy: '', verificationDate: '' });

            useEffect(() => {
                if (existingRecord) { setFormData(existingRecord); }
                else { setFormData({ courseId: '', completedDate: '', expiryDate: '', provider: '', notes: '', certificateNumber: '', verifiedBy: '', verificationDate: '' }); }
            }, [existingRecord, isOpen]);

            const selectedCourse = courses.find(c => c.id === formData.courseId);

            const handleCourseChange = (courseId) => {
                const course = courses.find(c => c.id === courseId);
                if (course) {
                    const updates = { courseId, provider: course.provider };
                    if (course.recertificationMonths && formData.completedDate) {
                        const completed = new Date(formData.completedDate);
                        const expiry = new Date(completed);
                        expiry.setMonth(expiry.getMonth() + course.recertificationMonths);
                        updates.expiryDate = expiry.toISOString().split('T')[0];
                    }
                    setFormData({...formData, ...updates});
                }
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave({ personId: person.id, competencyId: competency.id, ...formData, recordId: existingRecord?.recordId || 'r' + Date.now() });
                onClose();
            };

            if (!isOpen) return null;

            return (
                <Modal isOpen={isOpen} onClose={onClose} title="Training Record" size="lg">
                    <div className="mb-4">
                        <p className="text-sm"><strong>Person:</strong> {person?.name}</p>
                        <p className="text-sm"><strong>Training:</strong> {competency?.name}</p>
                    </div>
                    <form onSubmit={handleSubmit} className="space-y-4">
                        <div>
                            <label className="block text-sm font-medium mb-1">Select Course *</label>
                            <select required className="w-full px-3 py-2 border rounded-lg" value={formData.courseId} onChange={(e) => handleCourseChange(e.target.value)}>
                                <option value="">Choose a course...</option>
                                {courses.map(course => <option key={course.id} value={course.id}>{course.name}</option>)}
                            </select>
                        </div>
                        {selectedCourse && (
                            <div className="bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm">
                                <p><strong>Provider:</strong> {selectedCourse.provider}</p>
                                {selectedCourse.duration && <p><strong>Duration:</strong> {selectedCourse.duration}</p>}
                                {selectedCourse.recertificationMonths && <p><strong>Recertification:</strong> Every {selectedCourse.recertificationMonths} months</p>}
                            </div>
                        )}
                        <div className="grid grid-cols-2 gap-4">
                            <div>
                                <label className="block text-sm font-medium mb-1">Completed Date *</label>
                                <input type="date" required className="w-full px-3 py-2 border rounded-lg" value={formData.completedDate} onChange={(e) => setFormData({...formData, completedDate: e.target.value})} />
                            </div>
                            <div>
                                <label className="block text-sm font-medium mb-1">Expiry Date</label>
                                <input type="date" className="w-full px-3 py-2 border rounded-lg" value={formData.expiryDate} onChange={(e) => setFormData({...formData, expiryDate: e.target.value})} />
                            </div>
                        </div>
                        <div>
                            <label className="block text-sm font-medium mb-1">Certificate Number</label>
                            <input type="text" className="w-full px-3 py-2 border rounded-lg" value={formData.certificateNumber} onChange={(e) => setFormData({...formData, certificateNumber: e.target.value})} />
                        </div>
                        <div>
                            <label className="block text-sm font-medium mb-1">Notes</label>
                            <textarea className="w-full px-3 py-2 border rounded-lg" rows="3" value={formData.notes} onChange={(e) => setFormData({...formData, notes: e.target.value})} />
                        </div>
                        <div className="flex gap-3">
                            <button type="submit" className="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">Save Record</button>
                            <button type="button" onClick={onClose} className="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
                        </div>
                    </form>
                </Modal>
            );
        }

        function TrainingManagementSystem() {
            const [roles, setRoles] = useState([]);
            const [competencies, setCompetencies] = useState([]);
            const [requirements, setRequirements] = useState({});
            const [people, setPeople] = useState([]);
            const [courses, setCourses] = useState([]);
            const [trainingRecords, setTrainingRecords] = useState([]);
            const [activeTab, setActiveTab] = useState('matrix');
            const [selectedPerson, setSelectedPerson] = useState(null);
            
            const [requirementModalOpen, setRequirementModalOpen] = useState(false);
            const [editingRequirement, setEditingRequirement] = useState(null);
            const [roleModalOpen, setRoleModalOpen] = useState(false);
            const [editingRole, setEditingRole] = useState(null);
            const [competencyModalOpen, setCompetencyModalOpen] = useState(false);
            const [editingCompetency, setEditingCompetency] = useState(null);
            const [courseModalOpen, setCourseModalOpen] = useState(false);
            const [editingCourse, setEditingCourse] = useState(null);
            const [trainingRecordModalOpen, setTrainingRecordModalOpen] = useState(false);
            const [editingRecord, setEditingRecord] = useState(null);

            useEffect(() => {
                const savedRoles = localStorage.getItem('trainingRoles');
                const savedCompetencies = localStorage.getItem('trainingCompetencies');
                const savedRequirements = localStorage.getItem('trainingRequirements');
                const savedPeople = localStorage.getItem('trainingPeople');
                const savedCourses = localStorage.getItem('trainingCourses');
                const savedRecords = localStorage.getItem('trainingRecords');
                
                setRoles(savedRoles ? JSON.parse(savedRoles) : INITIAL_ROLES);
                setCompetencies(savedCompetencies ? JSON.parse(savedCompetencies) : INITIAL_COMPETENCIES);
                setRequirements(savedRequirements ? JSON.parse(savedRequirements) : INITIAL_REQUIREMENTS);
                setPeople(savedPeople ? JSON.parse(savedPeople) : INITIAL_PEOPLE);
                setCourses(savedCourses ? JSON.parse(savedCourses) : INITIAL_COURSES);
                setTrainingRecords(savedRecords ? JSON.parse(savedRecords) : []);
            }, []);

            const saveRoles = (newRoles) => {
                setRoles(newRoles);
                localStorage.setItem('trainingRoles', JSON.stringify(newRoles));
            };

            const saveCompetencies = (newCompetencies) => {
                setCompetencies(newCompetencies);
                localStorage.setItem('trainingCompetencies', JSON.stringify(newCompetencies));
            };

            const saveRequirements = (newRequirements) => {
                setRequirements(newRequirements);
                localStorage.setItem('trainingRequirements', JSON.stringify(newRequirements));
            };

            const saveCourses = (newCourses) => {
                setCourses(newCourses);
                localStorage.setItem('trainingCourses', JSON.stringify(newCourses));
            };

            const saveRecords = (newRecords) => {
                setTrainingRecords(newRecords);
                localStorage.setItem('trainingRecords', JSON.stringify(newRecords));
            };

            const handleSaveRequirement = (compId, roleId, requirement) => {
                const newRequirements = {...requirements};
                if (!newRequirements[compId]) newRequirements[compId] = {};
                if (requirement) {
                    newRequirements[compId][roleId] = requirement;
                } else {
                    delete newRequirements[compId][roleId];
                }
                saveRequirements(newRequirements);
            };

            const handleSaveRole = (role) => {
                const existing = roles.findIndex(r => r.id === role.id);
                if (existing >= 0) {
                    const updated = [...roles];
                    updated[existing] = role;
                    saveRoles(updated);
                } else {
                    saveRoles([...roles, role]);
                }
            };

            const handleSaveCompetency = (comp) => {
                const existing = competencies.findIndex(c => c.id === comp.id);
                if (existing >= 0) {
                    const updated = [...competencies];
                    updated[existing] = comp;
                    saveCompetencies(updated);
                } else {
                    saveCompetencies([...competencies, comp]);
                }
            };

            const handleSaveCourse = (course) => {
                const existing = courses.findIndex(c => c.id === course.id);
                if (existing >= 0) {
                    const updated = [...courses];
                    updated[existing] = course;
                    saveCourses(updated);
                } else {
                    saveCourses([...courses, course]);
                }
                setEditingCourse(null);
            };

            const handleDeleteCourse = (courseId) => {
                if (confirm('Delete this course?')) {
                    saveCourses(courses.filter(c => c.id !== courseId));
                }
            };

            const handleSaveTrainingRecord = (record) => {
                const existing = trainingRecords.findIndex(r => r.personId === record.personId && r.competencyId === record.competencyId);
                if (existing >= 0) {
                    const updated = [...trainingRecords];
                    updated[existing] = record;
                    saveRecords(updated);
                } else {
                    saveRecords([...trainingRecords, record]);
                }
                setEditingRecord(null);
            };

            const getTrainingStatus = (record) => {
                if (!record) return 'pending';
                if (!record.expiryDate) return 'complete';
                const today = new Date();
                const expiry = new Date(record.expiryDate);
                const days = Math.floor((expiry - today) / (1000 * 60 * 60 * 24));
                if (days < 0) return 'expired';
                if (days <= 30) return 'expiring';
                return 'complete';
            };

            const getStatusBadge = (status) => {
                const classes = { complete: 'status-complete', expiring: 'status-expiring', expired: 'status-expired', pending: 'status-pending' };
                const labels = { complete: 'Current', expiring: 'Expiring Soon', expired: 'Expired', pending: 'Not Completed' };
                return <span className={`px-2 py-1 rounded text-xs font-semibold ${classes[status]}`}>{labels[status]}</span>;
            };

            return (
                <div className="min-h-screen bg-gray-50">
                    <div className="bg-blue-600 text-white p-6 shadow-lg">
                        <h1 className="text-3xl font-bold">Training Management System</h1>
                        <p className="mt-2 text-blue-100">Cook Shire Council</p>
                    </div>

                    <div className="bg-white shadow">
                        <div className="flex border-b">
                            <button onClick={() => setActiveTab('matrix')} className={`px-6 py-3 font-semibold ${activeTab === 'matrix' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-gray-600'}`}>Competency Matrix</button>
                            <button onClick={() => setActiveTab('courses')} className={`px-6 py-3 font-semibold ${activeTab === 'courses' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-gray-600'}`}>Training Courses</button>
                            <button onClick={() => setActiveTab('people')} className={`px-6 py-3 font-semibold ${activeTab === 'people' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-gray-600'}`}>People & Records</button>
                            <button onClick={() => setActiveTab('reports')} className={`px-6 py-3 font-semibold ${activeTab === 'reports' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-gray-600'}`}>Reports</button>
                        </div>
                    </div>

                    <div className="p-6">
                        {activeTab === 'matrix' && (
                            <div className="bg-white rounded-lg shadow-lg p-6">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-xl font-bold">Competency Requirements Matrix</h2>
                                    <div className="flex gap-2">
                                        <button onClick={() => { setEditingRole(null); setRoleModalOpen(true); }} className="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 text-sm">+ Add Role</button>
                                        <button onClick={() => { setEditingCompetency(null); setCompetencyModalOpen(true); }} className="bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600 text-sm">+ Add Competency</button>
                                    </div>
                                </div>
                                <div className="flex gap-4 mb-4 text-xs">
                                    <div className="flex items-center gap-1"><span className="px-2 py-1 rounded bg-red-500 text-white font-semibold">M(A)</span> Mandatory (All)</div>
                                    <div className="flex items-center gap-1"><span className="px-2 py-1 rounded bg-red-500 text-white font-semibold">M(S)</span> Mandatory (Specific)</div>
                                    <div className="flex items-center gap-1"><span className="px-2 py-1 rounded bg-blue-500 text-white font-semibold">D(A)</span> Desirable (All)</div>
                                    <div className="flex items-center gap-1"><span className="px-2 py-1 rounded bg-blue-500 text-white font-semibold">D(S)</span> Desirable (Specific)</div>
                                </div>
                                <div className="overflow-x-auto">
                                    <table className="w-full border-collapse border">
                                        <thead>
                                            <tr className="bg-gray-100">
                                                <th className="border p-3 text-left text-sm">Competency</th>
                                                <th className="border p-3 text-left text-sm">Category</th>
                                                {roles.map(role => (
                                                    <th key={role.id} className="border p-2 text-xs">
                                                        <div>{role.name}</div>
                                                        <div className="text-gray-500 font-normal">{role.department}</div>
                                                    </th>
                                                ))}
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {competencies.map((comp, idx) => (
                                                <tr key={comp.id} className={idx % 2 === 0 ? 'bg-white' : 'bg-gray-50'}>
                                                    <td className="border p-3 text-sm">{comp.name}</td>
                                                    <td className="border p-3 text-xs text-gray-600">{comp.category}</td>
                                                    {roles.map(role => {
                                                        const req = requirements[comp.id]?.[role.id];
                                                        return (
                                                            <td key={role.id} className="border p-2 text-center">
                                                                <button
                                                                    onClick={() => {
                                                                        setEditingRequirement({ competency: comp, role, currentRequirement: req });
                                                                        setRequirementModalOpen(true);
                                                                    }}
                                                                    className="w-full hover:bg-gray-100 p-1 rounded"
                                                                >
                                                                    {req ? (
                                                                        <span className={`px-2 py-1 rounded text-xs font-semibold ${req.startsWith('M') ? 'bg-red-500 text-white' : 'bg-blue-500 text-white'}`}>{req}</span>
                                                                    ) : (
                                                                        <span className="text-gray-400 text-xs">click</span>
                                                                    )}
                                                                </button>
                                                            </td>
                                                        );
                                                    })}
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}

                        {activeTab === 'courses' && (
                            <div className="bg-white rounded-lg shadow-lg p-6">
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-xl font-bold">Training Courses Library</h2>
                                    <button onClick={() => { setEditingCourse(null); setCourseModalOpen(true); }} className="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">+ Add Course</button>
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    {courses.map(course => (
                                        <div key={course.id} className="border rounded-lg p-4">
                                            <div className="flex justify-between mb-2">
                                                <h3 className="font-bold">{course.name}</h3>
                                                <button onClick={() => handleDeleteCourse(course.id)} className="text-red-500">Ã—</button>
                                            </div>
                                            <div className="text-sm space-y-1 mb-3">
                                                <span className={`inline-block px-2 py-1 rounded text-xs ${course.providerType === 'internal' ? 'badge-internal' : 'badge-external'}`}>
                                                    {course.providerType === 'internal' ? 'Internal' : 'External'}
                                                </span>
                                                <p><strong>Provider:</strong> {course.provider}</p>
                                                {course.duration && <p><strong>Duration:</strong> {course.duration}</p>}
                                                {course.recertificationMonths && <p><strong>Recert:</strong> {course.recertificationMonths} months</p>}
                                            </div>
                                            <button onClick={() => { setEditingCourse(course); setCourseModalOpen(true); }} className="w-full bg-gray-100 px-3 py-2 rounded text-sm">Edit</button>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {activeTab === 'people' && (
                            <div>
                                <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                                    <h2 className="text-xl font-bold mb-4">Staff Members</h2>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        {people.map(person => (
                                            <div key={person.id} className="border rounded-lg p-4">
                                                <h3 className="font-bold">{person.name}</h3>
                                                <p className="text-sm text-gray-600">{roles.find(r => r.id === person.roleId)?.name}</p>
                                                <button onClick={() => setSelectedPerson(person)} className="w-full mt-3 bg-blue-500 text-white px-3 py-2 rounded text-sm">View Training</button>
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                {selectedPerson && (
                                    <div className="bg-white rounded-lg shadow-lg p-6">
                                        <div className="flex justify-between mb-4">
                                            <h2 className="text-xl font-bold">{selectedPerson.name} - Training Records</h2>
                                            <button onClick={() => setSelectedPerson(null)} className="text-gray-500">Close</button>
                                        </div>
                                        <div className="space-y-3">
                                            {competencies.filter(comp => requirements[comp.id]?.[selectedPerson.roleId]).map(comp => {
                                                const record = trainingRecords.find(r => r.personId === selectedPerson.id && r.competencyId === comp.id);
                                                const course = record ? courses.find(c => c.id === record.courseId) : null;
                                                const status = getTrainingStatus(record);
                                                return (
                                                    <div key={comp.id} className="border rounded-lg p-4">
                                                        <div className="flex justify-between">
                                                            <div>
                                                                <h4 className="font-semibold">{comp.name}</h4>
                                                                {record && course && (
                                                                    <div className="mt-2 text-sm">
                                                                        <p><strong>Course:</strong> {course.name}</p>
                                                                        <p><strong>Completed:</strong> {record.completedDate}</p>
                                                                        {record.expiryDate && <p><strong>Expires:</strong> {record.expiryDate}</p>}
                                                                    </div>
                                                                )}
                                                            </div>
                                                            <div className="flex flex-col gap-2">
                                                                {getStatusBadge(status)}
                                                                <button onClick={() => { setEditingRecord({ competency: comp, person: selectedPerson, record }); setTrainingRecordModalOpen(true); }} className="text-blue-500 text-sm">
                                                                    {record ? 'Edit' : 'Add'}
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        {activeTab === 'reports' && (
                            <div className="bg-white rounded-lg shadow-lg p-6">
                                <h2 className="text-xl font-bold mb-4">Reports</h2>
                                <p className="text-gray-600">Reporting functionality coming soon...</p>
                            </div>
                        )}
                    </div>

                    <RequirementModal isOpen={requirementModalOpen} onClose={() => setRequirementModalOpen(false)} onSave={handleSaveRequirement} competency={editingRequirement?.competency} role={editingRequirement?.role} currentRequirement={editingRequirement?.currentRequirement} />
                    <RoleModal isOpen={roleModalOpen} onClose={() => { setRoleModalOpen(false); setEditingRole(null); }} onSave={handleSaveRole} existingRole={editingRole} />
                    <CompetencyModal isOpen={competencyModalOpen} onClose={() => { setCompetencyModalOpen(false); setEditingCompetency(null); }} onSave={handleSaveCompetency} existingCompetency={editingCompetency} />
                    <CourseModal isOpen={courseModalOpen} onClose={() => { setCourseModalOpen(false); setEditingCourse(null); }} onSave={handleSaveCourse} existingCourse={editingCourse} />
                    <TrainingRecordModal isOpen={trainingRecordModalOpen} onClose={() => { setTrainingRecordModalOpen(false); setEditingRecord(null); }} onSave={handleSaveTrainingRecord} person={editingRecord?.person} competency={editingRecord?.competency} existingRecord={editingRecord?.record} courses={courses} />
                </div>
            );
        }

        ReactDOM.render(<TrainingManagementSystem />, document.getElementById('root'));
    </script>
</body>
</html>
