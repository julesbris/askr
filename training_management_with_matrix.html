<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Training Management System - Cook Shire Council</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        .badge-internal { background: #10b981; color: white; }
        .badge-external { background: #8b5cf6; color: white; }
        .status-complete { background: #22c55e; color: white; }
        .status-expiring { background: #f59e0b; color: white; }
        .status-expired { background: #ef4444; color: white; }
        .status-pending { background: #94a3b8; color: white; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script>
        const FULL_MATRIX_DATA = 
{"roles": [{"id": "role_0", "name": "M(A) - Mandatory (All) M(S) - Mandatory (Specific) D(A) - Desirable (Specific All) D(S) - Desirable (Specific Staff)", "department": ""}, {"id": "role_1", "name": "Depot Administration Officer", "department": "Fleet & Civil Works"}, {"id": "role_2", "name": "Diesel Fitter", "department": ""}, {"id": "role_3", "name": "Apprentice Diesel Fitter", "department": ""}, {"id": "role_4", "name": "Civil Construction Labourer / Relief Plant", "department": ""}, {"id": "role_5", "name": "Grader Operator", "department": ""}, {"id": "role_6", "name": "Truck Driver / Labourer", "department": ""}, {"id": "role_7", "name": "Civil Construction Plant Operator", "department": ""}, {"id": "role_8", "name": "Civil Construction Labourer", "department": ""}, {"id": "role_9", "name": "Civil Construction Ganger", "department": ""}, {"id": "role_10", "name": "Trade Assistant (Water & Wastewater)", "department": ""}, {"id": "role_11", "name": "Maintenance Technician", "department": ""}, {"id": "role_12", "name": "Boilermaker", "department": ""}, {"id": "role_13", "name": "Concrete Labourer", "department": ""}, {"id": "role_14", "name": "Concrete Finisher", "department": ""}, {"id": "role_15", "name": "Civil Works Construction Foreman", "department": ""}, {"id": "role_16", "name": "Structural Foreperson", "department": ""}, {"id": "role_17", "name": "Workshop Foreman", "department": ""}, {"id": "role_18", "name": "Manager Fleet & Workshop", "department": ""}, {"id": "role_19", "name": "Survey & GIS Technical Officer", "department": ""}, {"id": "role_20", "name": "Civil Operations Coordinator", "department": ""}, {"id": "role_21", "name": "Project Manager", "department": "Engineering"}, {"id": "role_22", "name": "Civil Operations Coordinator", "department": ""}, {"id": "role_23", "name": "Project Engineer", "department": ""}, {"id": "role_24", "name": "Project Support Officer", "department": ""}, {"id": "role_25", "name": "Parks & Gardens Coordinator", "department": ""}, {"id": "role_26", "name": "Botanic Gardens Curator", "department": ""}, {"id": "role_27", "name": "Manager Engineering", "department": ""}, {"id": "role_28", "name": "Administration Technical Officer", "department": "Water & Waste"}, {"id": "role_29", "name": "Rubbish Collection and Disposal", "department": ""}, {"id": "role_30", "name": "Waste Management Operator - Lakeland & Laura", "department": ""}, {"id": "role_31", "name": "Waste Management Operator - Ayton", "department": ""}, {"id": "role_32", "name": "Waste Management Operator - Cooktown", "department": ""}, {"id": "role_33", "name": "Plumbers (Water & Wastewater)", "department": ""}, {"id": "role_34", "name": "Apprentice Plumber", "department": ""}, {"id": "role_35", "name": "Leading Hand / Relief Plant Operator", "department": ""}, {"id": "role_36", "name": "Water & Wastewater Network Operator", "department": ""}, {"id": "role_37", "name": "Water & Wastewater Treatment Plant Operator - Cooktown", "department": ""}, {"id": "role_38", "name": "Water & Wastewater Treatment Plant Operator - Coen", "department": ""}, {"id": "role_39", "name": "Team Leader Reticulation, Water & Treatment", "department": ""}, {"id": "role_40", "name": "Electrician Water & Wastewater", "department": ""}, {"id": "role_41", "name": "Apprentice Electrician", "department": ""}, {"id": "role_42", "name": "Waste Management Coordinator", "department": ""}, {"id": "role_43", "name": "Manager Water & Waste", "department": ""}, {"id": "role_44", "name": "Manager Water & Waste", "department": ""}, {"id": "role_45", "name": "Coen Coordinator and Airport Reporting Officer", "department": "Airports"}, {"id": "role_46", "name": "Airport Reporting Officer", "department": ""}, {"id": "role_47", "name": "Cooktown Airport Operations Officer", "department": ""}, {"id": "role_48", "name": "Manager Airports", "department": ""}, {"id": "role_49", "name": "DRFA Contractors", "department": "DRFA"}, {"id": "role_50", "name": "DRFA Forepersons", "department": ""}, {"id": "role_51", "name": "Delivery Coordinator DRFA Works", "department": ""}, {"id": "role_52", "name": "DRFA Operations Coordinator", "department": ""}, {"id": "role_53", "name": "DRFA Project Officer", "department": ""}, {"id": "role_54", "name": "DRFA Administration Support Officer", "department": ""}, {"id": "role_55", "name": "Lead Systems Developer", "department": ""}, {"id": "role_56", "name": "DRFA Systems Developer", "department": ""}, {"id": "role_57", "name": "Manager - DRFA Works", "department": ""}, {"id": "role_58", "name": "Parks & Gardens Labourers", "department": "Parks and Gardens"}, {"id": "role_59", "name": "Botanic Gardens Labourers", "department": ""}, {"id": "role_60", "name": "Parks & Gardens Ganger", "department": ""}, {"id": "role_61", "name": "Botanic Gardens Ganger", "department": ""}, {"id": "role_62", "name": "Horticulturalist", "department": ""}, {"id": "role_63", "name": "Parks & Gardens Coordinator", "department": ""}, {"id": "role_64", "name": "Curator Botanic Gardens", "department": ""}, {"id": "role_65", "name": "Payroll Officer", "department": "Financial Services"}, {"id": "role_66", "name": "Accounts Payable Officer", "department": ""}, {"id": "role_67", "name": "Stores Officer", "department": ""}, {"id": "role_68", "name": "Rates Officer", "department": ""}, {"id": "role_69", "name": "Senior Accounts Officer", "department": ""}, {"id": "role_70", "name": "Senior Finance Officer", "department": ""}, {"id": "role_71", "name": "Accountant", "department": ""}, {"id": "role_72", "name": "Housing Officer", "department": ""}, {"id": "role_73", "name": "Property & Commercial Services Coordinator", "department": ""}, {"id": "role_74", "name": "Asset Coordinator", "department": ""}, {"id": "role_75", "name": "Procurement Coordinator", "department": ""}, {"id": "role_76", "name": "Finance Manager", "department": ""}, {"id": "role_77", "name": "Chief Financial Officer", "department": ""}, {"id": "role_78", "name": "ICT Operations & Support Officer", "department": "Information & Communications Technology"}, {"id": "role_79", "name": "ICT Coordinator", "department": ""}, {"id": "role_80", "name": "ICT System Administrator", "department": ""}, {"id": "role_81", "name": "ICT Administration Officer", "department": ""}, {"id": "role_82", "name": "ICT Operations & Support Officer", "department": ""}, {"id": "role_83", "name": "Media & Communications Officer", "department": "Communications & Engagement"}, {"id": "role_84", "name": "Indigenous (Bama) Patnerships Officer", "department": ""}, {"id": "role_85", "name": "Communications & Engagement Manager", "department": ""}, {"id": "role_86", "name": "Safety & Training Advisor", "department": "People and Performance"}, {"id": "role_87", "name": "WHS Manager", "department": ""}, {"id": "role_88", "name": "Senior HR Advisor (Infrastructure)", "department": ""}, {"id": "role_89", "name": "Senior HR Advisor", "department": ""}, {"id": "role_90", "name": "Administration Officer P&P", "department": ""}, {"id": "role_91", "name": "Executive Manager  P&P", "department": ""}, {"id": "role_92", "name": "Building & Facilities Support Officer", "department": "Building & Facilities"}, {"id": "role_93", "name": "Buliding & Facilities Support Officer", "department": ""}, {"id": "role_94", "name": "Cleaners", "department": ""}, {"id": "role_95", "name": "Team Leader - Cleaning", "department": ""}, {"id": "role_96", "name": "Casual Cleaner - Coen", "department": ""}, {"id": "role_97", "name": "Senior Cleaner Coen", "department": ""}, {"id": "role_98", "name": "Project Officer", "department": ""}, {"id": "role_99", "name": "Coen Public Spaces", "department": ""}, {"id": "role_100", "name": "Coen Waste Management Plant Operator", "department": ""}, {"id": "role_101", "name": "Plumber", "department": ""}, {"id": "role_102", "name": "Lead Electrician", "department": ""}, {"id": "role_103", "name": "Trade Assistant", "department": ""}, {"id": "role_104", "name": "Maintenance Coordinator - Coen", "department": ""}, {"id": "role_105", "name": "Carpenter", "department": ""}, {"id": "role_106", "name": "Chief Operating Officer", "department": ""}, {"id": "role_107", "name": "Facilities & Projects Manager", "department": ""}, {"id": "role_108", "name": "Local Laws Officer", "department": "Planning & Environment"}, {"id": "role_109", "name": "Biosecurity Operator", "department": ""}, {"id": "role_110", "name": "Biosecurity Officer", "department": ""}, {"id": "role_111", "name": "Animal Management Officer", "department": ""}, {"id": "role_112", "name": "Compliance Officer", "department": ""}, {"id": "role_113", "name": "Biosecurity & Local Laws Manager", "department": ""}, {"id": "role_114", "name": "Planning Officer", "department": ""}, {"id": "role_115", "name": "P & E Administration Officer", "department": ""}, {"id": "role_116", "name": "P & E Administration Officer", "department": ""}, {"id": "role_117", "name": "Plumbing & Drainage Inspector", "department": ""}, {"id": "role_118", "name": "Environmental Health Officer", "department": ""}, {"id": "role_119", "name": "Land Tenure Officer", "department": ""}, {"id": "role_120", "name": "Library Officer Bloomfield", "department": "Community Lifestyle"}, {"id": "role_121", "name": "Library Officer Cooktown", "department": ""}, {"id": "role_122", "name": "Team Leader Library Services", "department": ""}, {"id": "role_123", "name": "Customer Service Officer", "department": ""}, {"id": "role_124", "name": "Team Leader Customer Service", "department": ""}, {"id": "role_125", "name": "Pool Attendant / Lifeguard / Instructor", "department": ""}, {"id": "role_126", "name": "Team Leader Cooktown Pool", "department": ""}, {"id": "role_127", "name": "Coen Sport & Recreational Officer", "department": ""}, {"id": "role_128", "name": "Community Lifestyle Coordinator", "department": ""}, {"id": "role_129", "name": "Administration Officer", "department": "Regional Development"}, {"id": "role_130", "name": "Casual Fitness Instructor", "department": ""}, {"id": "role_131", "name": "Casual Cleaner Venue Support", "department": ""}, {"id": "role_132", "name": "Cooktown Events Centre Manager", "department": ""}, {"id": "role_133", "name": "Funding & Business Development Officer", "department": ""}, {"id": "role_134", "name": "Natures Powerhouse Caf\u00e9", "department": ""}, {"id": "role_135", "name": "Community Connections & Events Officer", "department": ""}, {"id": "role_136", "name": "Senior Tourism & Events Officer", "department": ""}, {"id": "role_137", "name": "Regional Arts Officer", "department": ""}, {"id": "role_138", "name": "Regional Development Manager", "department": ""}, {"id": "role_139", "name": "Regional Development Manager", "department": "Growth & Liveability"}, {"id": "role_140", "name": "Community Lifestyle Coordinator", "department": ""}, {"id": "role_141", "name": "Planning & Environment Manager", "department": ""}, {"id": "role_142", "name": "Facilities & Projects Manager", "department": ""}, {"id": "role_143", "name": "Communications Engagement Manager", "department": ""}, {"id": "role_144", "name": "Information & Communications Technology Manager", "department": ""}, {"id": "role_145", "name": "Disaster Management Officer", "department": ""}, {"id": "role_146", "name": "Executive Assistant", "department": ""}, {"id": "role_147", "name": "Chief Operating Officer", "department": ""}, {"id": "role_148", "name": "Excecutive Assistant", "department": "Infrastructure"}, {"id": "role_149", "name": "Director Infrastructure", "department": ""}, {"id": "role_150", "name": "Records Management Officer", "department": "Office of the CEO"}, {"id": "role_151", "name": "Senior Records Management Officer", "department": ""}, {"id": "role_152", "name": "Governance Coordinator", "department": ""}, {"id": "role_153", "name": "Administration Officer", "department": ""}, {"id": "role_154", "name": "Audit, Risk & Grants Officer", "department": ""}, {"id": "role_155", "name": "Manager Office of the CEO", "department": ""}, {"id": "role_156", "name": "Chief Executive Officer", "department": ""}], "competencies": [{"id": "comp_0", "name": "Working with Children check (Blue Card)", "category": ""}, {"id": "comp_1", "name": "Immunisation Requirments", "category": ""}, {"id": "comp_2", "name": "Prepare to work safely in the construction industry (white card)", "category": ""}, {"id": "comp_3", "name": "Car ( C)", "category": "Vehicle Licence \nCodes"}, {"id": "comp_4", "name": "Light rigid (LR)", "category": ""}, {"id": "comp_5", "name": "Medium rigid (MR)", "category": ""}, {"id": "comp_6", "name": "Heavy Rigid (HR)", "category": ""}, {"id": "comp_7", "name": "Heavey Combination (HC)", "category": ""}, {"id": "comp_8", "name": "Multi Combination (MC)", "category": ""}, {"id": "comp_9", "name": "Chain of Responsibility (related to heavy vehicles)", "category": "HV"}, {"id": "comp_10", "name": "Towing", "category": "Towing"}, {"id": "comp_11", "name": "Recover 4WD vehicles", "category": "4WD"}, {"id": "comp_12", "name": "Operate and Maintain 4WD vehicle", "category": ""}, {"id": "comp_13", "name": "Dozer (LZ licence code)", "category": "Earthmoving"}, {"id": "comp_14", "name": "Skid steer loader (LS licence code)", "category": ""}, {"id": "comp_15", "name": "Grader (LG licence code)", "category": ""}, {"id": "comp_16", "name": "Scraper (LP licence code)", "category": ""}, {"id": "comp_17", "name": "Road Roller (LR licence code)", "category": ""}, {"id": "comp_18", "name": "Excavator (LE licence code)", "category": ""}, {"id": "comp_19", "name": "Bridge and gantry (remote control crane) (LBG licence code)", "category": ""}, {"id": "comp_20", "name": "Front-end loader backhoe (LB licence code)", "category": ""}, {"id": "comp_21", "name": "Trenching & Excavation", "category": ""}, {"id": "comp_22", "name": "Load Restraint", "category": ""}, {"id": "comp_23", "name": "Load and Unload Plant", "category": ""}, {"id": "comp_24", "name": "Traffic Management Implementation (TMI) (Every three years)", "category": "Traffic"}, {"id": "comp_25", "name": "Traffic Controller", "category": ""}, {"id": "comp_26", "name": "Traffic AGTTM (every two years)", "category": ""}, {"id": "comp_27", "name": "Traffic Management design", "category": ""}, {"id": "comp_28", "name": "Practical TTM for Local Streets", "category": ""}, {"id": "comp_29", "name": "Work in Proximity to traffic 1 & 2", "category": ""}, {"id": "comp_30", "name": "Marine licence", "category": "Marine"}, {"id": "comp_31", "name": "Tractor - Slasher, Broom, Flail, Cemetery tractor (VOC)", "category": "Other plant & equipment"}, {"id": "comp_32", "name": "Tilt  Tray/Plant Trailer", "category": ""}, {"id": "comp_33", "name": "Float", "category": ""}, {"id": "comp_34", "name": "Flocon", "category": ""}, {"id": "comp_35", "name": "Patching Truck", "category": ""}, {"id": "comp_36", "name": "Street Sweeper", "category": ""}, {"id": "comp_37", "name": "Mower, Ride-on, Swiss, Boom, Out-front", "category": ""}, {"id": "comp_38", "name": "Quad / ATV", "category": ""}, {"id": "comp_39", "name": "Concrete placing boom (PB) (HRWL)", "category": "High Risk Work Licence"}, {"id": "comp_40", "name": "Personnel and materials hoist (HP) (HRWL)", "category": ""}, {"id": "comp_41", "name": "Demolition work licence (HRWL)", "category": ""}, {"id": "comp_42", "name": "Vehicle loading crane (VLC) (HRWL)", "category": ""}, {"id": "comp_43", "name": "Slewing mobile cranes (C2, C6, C1, C)_ (HRWL)", "category": ""}, {"id": "comp_44", "name": "Derrick crane (CD) (HRWL)", "category": ""}, {"id": "comp_45", "name": "Portal boom crane (CP) (HRWL)", "category": ""}, {"id": "comp_46", "name": "Non-slewing mobile crane (CN) (HRWL)", "category": ""}, {"id": "comp_47", "name": "Tower crane (CT) (HRWL)", "category": ""}, {"id": "comp_48", "name": "Asbestos licence (class A) (HRWL)", "category": ""}, {"id": "comp_49", "name": "Asbestos licence (class B) (HRWL)", "category": ""}, {"id": "comp_50", "name": "Dogger (DG) (HRWL)", "category": ""}, {"id": "comp_51", "name": "Basic rigging (RB) (HRWL)", "category": ""}, {"id": "comp_52", "name": "Intermediate rigging work (RI) (HRWL)", "category": ""}, {"id": "comp_53", "name": "Advanced rigging work (RA) (HRWL)", "category": ""}, {"id": "comp_54", "name": "Basic scaffolding work (SB) (HRWL)", "category": ""}, {"id": "comp_55", "name": "Intermediate scaffolding (SI) (HRWL)", "category": ""}, {"id": "comp_56", "name": "Advanced scaffolding (SA (HRWL)", "category": ""}, {"id": "comp_57", "name": "Standard boiler (BS) (HRWL)", "category": ""}, {"id": "comp_58", "name": "Advanced boiler operation (BA) (HRWL)", "category": ""}, {"id": "comp_59", "name": "Forklift (LF) (HRWL)", "category": ""}, {"id": "comp_60", "name": "Vertical Lift (VL)", "category": "EW\n(Yellow Card)"}, {"id": "comp_61", "name": "Scissor Lift (SL)", "category": ""}, {"id": "comp_62", "name": "Self-Propelled Boom Lift (TL)", "category": ""}, {"id": "comp_63", "name": "Truck Mounted Lift \u2122", "category": ""}, {"id": "comp_64", "name": "Advanced Boom (AB)", "category": ""}, {"id": "comp_65", "name": "Working at Heights", "category": "WAH"}, {"id": "comp_66", "name": "Electrical Mechanic Licence", "category": "Electrical"}, {"id": "comp_67", "name": "Electrical Linesperson Licence", "category": ""}, {"id": "comp_68", "name": "Electrical Fitter Licence", "category": ""}, {"id": "comp_69", "name": "Electrical Jointer Licence", "category": ""}, {"id": "comp_70", "name": "Restricted Electrical Work Licence", "category": ""}, {"id": "comp_71", "name": "Electrical Contractor Licence", "category": ""}, {"id": "comp_72", "name": "Restricted Electrical Contractor Licence", "category": ""}, {"id": "comp_73", "name": "Electrical Spotter", "category": ""}, {"id": "comp_74", "name": "Before You Dig", "category": ""}, {"id": "comp_75", "name": "Low Vaultage and Rescue (3 years?)", "category": ""}, {"id": "comp_76", "name": "Air Conditioning Installation (Split Systems)", "category": ""}, {"id": "comp_77", "name": "Electrical awareness", "category": ""}, {"id": "comp_78", "name": "Confined Space permit Issuer", "category": "Confined Space"}, {"id": "comp_79", "name": "Gas Test Atmospheres", "category": ""}, {"id": "comp_80", "name": "Breathing Apparatus", "category": ""}, {"id": "comp_81", "name": "Confined Space Entry", "category": ""}, {"id": "comp_82", "name": "Firearm Licences (Category A)", "category": "Firearms"}, {"id": "comp_83", "name": "Firearm Licences (Category B)", "category": ""}, {"id": "comp_84", "name": "Operate High Pressure Water Jetting System", "category": "Tools & Equipment"}, {"id": "comp_85", "name": "Cut materials with a hand-held chainsaw", "category": ""}, {"id": "comp_86", "name": "Operate Pole Saw", "category": ""}, {"id": "comp_87", "name": "Service and repair chansaw cutting systems", "category": ""}, {"id": "comp_88", "name": "Use a chainsaaw withing a tree", "category": ""}, {"id": "comp_89", "name": "Operate a mobile chipper", "category": ""}, {"id": "comp_90", "name": "Operate a Infield Wood Chipping Machine Operator Skill Set (Flail & Wood Chipper with Crane)", "category": ""}, {"id": "comp_91", "name": "Assessor / Repairer - chainsaws, quick-cut saws", "category": ""}, {"id": "comp_92", "name": "Trim and Cut felled trees", "category": ""}, {"id": "comp_93", "name": "Fell trees manually (advanced)", "category": ""}, {"id": "comp_94", "name": "Quick Cut saw", "category": ""}, {"id": "comp_95", "name": "Chemical Handling", "category": "Hazardous Substances"}, {"id": "comp_96", "name": "Stychnine Poison (1080)", "category": ""}, {"id": "comp_97", "name": "Asbestos Awareness", "category": ""}, {"id": "comp_98", "name": "Poisons and invasive weeds / Threat Weeds", "category": ""}, {"id": "comp_99", "name": "Liquefied Chlorine (NWPTRT007)", "category": ""}, {"id": "comp_100", "name": "Commercial Operators Licence (Chemicals)  ACDC - Agricultural Chemicals Distribution Control", "category": ""}, {"id": "comp_101", "name": "LDMG (Disaster mgt)", "category": ""}, {"id": "comp_102", "name": "AISIMS", "category": "Disaster response"}, {"id": "comp_103", "name": "Control a Level 1 Incident", "category": ""}, {"id": "comp_104", "name": "Control a level 2 Incident", "category": ""}, {"id": "comp_105", "name": "Type 1 Planned Burn", "category": ""}, {"id": "comp_106", "name": "Fire Weather 1", "category": ""}, {"id": "comp_107", "name": "Overall Fuel Hazard", "category": ""}, {"id": "comp_108", "name": "Fire Crew", "category": ""}, {"id": "comp_109", "name": "Fire Crew Leader", "category": ""}, {"id": "comp_110", "name": "Dangerous Annimal Handling", "category": "Animal\nManagement"}, {"id": "comp_111", "name": "Dog Bite Prevention", "category": ""}, {"id": "comp_112", "name": "Animal Management", "category": ""}, {"id": "comp_113", "name": "Snake Awareness", "category": ""}, {"id": "comp_114", "name": "WHS / OHS Managers & Supervisors", "category": "WHS Awareness & Competencies"}, {"id": "comp_115", "name": "First Aid HLTAID011 3 yrly/ CPR HLTAID009 1 yrly", "category": ""}, {"id": "comp_116", "name": "Health & Safety Representative Training", "category": ""}, {"id": "comp_117", "name": "Rehabilitation and return to work coordinator training", "category": ""}, {"id": "comp_118", "name": "Collect specimens for drugs of abuse testing (TDDA)", "category": ""}, {"id": "comp_119", "name": "Due Dilligence", "category": ""}, {"id": "comp_120", "name": "Duty of Care", "category": ""}, {"id": "comp_121", "name": "Chain of Responsibility", "category": ""}, {"id": "comp_122", "name": "Fire Wardent", "category": ""}, {"id": "comp_123", "name": "Chief Fire Warden", "category": ""}, {"id": "comp_124", "name": "Mental Health First Aid", "category": ""}, {"id": "comp_125", "name": "Oil Spill Response", "category": ""}, {"id": "comp_126", "name": "Remote Work Device (in-reach)", "category": ""}, {"id": "comp_127", "name": "Test & Tag", "category": ""}, {"id": "comp_128", "name": "Civil Supervisor Workshop (every 3 years)", "category": "Civil Works"}, {"id": "comp_129", "name": "Road and Structural Certification", "category": ""}, {"id": "comp_130", "name": "ARRB Best Practice Guides Sealed & Unsealed Roads", "category": ""}, {"id": "comp_131", "name": "Manageing Unsealed Roads (every 3 years)", "category": ""}, {"id": "comp_132", "name": "Managing risk on Lower Order Roads (every 3 years)", "category": ""}, {"id": "comp_133", "name": "Bridge Inspection Level 1 & 2", "category": ""}, {"id": "comp_134", "name": "Sprayed Seal Road Design (every 2 years)", "category": ""}, {"id": "comp_135", "name": "Backflow Prevention (Plumbers)", "category": "Water & Waste"}, {"id": "comp_136", "name": "Dam safety surveillance /  Dam safety operations", "category": ""}, {"id": "comp_137", "name": "CCTV / Inspect water/stormwater pipes", "category": ""}, {"id": "comp_138", "name": "Undertake sampling and testing of water", "category": ""}, {"id": "comp_139", "name": "QUDM Drainage (every 3 years)", "category": ""}, {"id": "comp_140", "name": "Sewage Treatment Plant Management", "category": ""}, {"id": "comp_141", "name": "Restricted refrigerant recoverer licence - non accredited", "category": ""}, {"id": "comp_142", "name": "Poly welding", "category": "Welding"}, {"id": "comp_143", "name": "Metal Welding", "category": ""}, {"id": "comp_144", "name": "Aerodrome Reporting Officer & Works Safety Officer", "category": "Airport Operations"}, {"id": "comp_145", "name": "Air Navigation", "category": ""}, {"id": "comp_146", "name": "VHF Radio Operators Certificate", "category": ""}, {"id": "comp_147", "name": "Aviation Fuel Dispensing", "category": ""}, {"id": "comp_148", "name": "Aviation Security Identification Card ASIC", "category": ""}, {"id": "comp_149", "name": "Certificate III or Deploma in Airside Operations", "category": ""}, {"id": "comp_150", "name": "Certificate II in Security Operations & Aviation Security", "category": ""}, {"id": "comp_151", "name": "Playground  assessment", "category": "Industry Specific Misc."}, {"id": "comp_152", "name": "Native Title and Cultural Heritage", "category": ""}, {"id": "comp_153", "name": "Heritage Buildings awareness", "category": ""}, {"id": "comp_154", "name": "IT Specialist skill sets", "category": ""}, {"id": "comp_155", "name": "Workshops specialised training (suppliers)", "category": ""}, {"id": "comp_156", "name": "Infection Control for Outdoor Workers (public areas)", "category": ""}, {"id": "comp_157", "name": "Commercial Drone Operation", "category": ""}, {"id": "comp_158", "name": "Drug & Alcohol Management Plan", "category": ""}, {"id": "comp_159", "name": "QBCC Qld Building & Construction Licence", "category": ""}, {"id": "comp_160", "name": "Armed Hold Up Response", "category": ""}, {"id": "comp_161", "name": "Cert II in Automotive Air Conditioning", "category": "Certificates and Qualifications"}, {"id": "comp_162", "name": "Year 10", "category": ""}, {"id": "comp_163", "name": "Fleet Management Certificate", "category": ""}, {"id": "comp_164", "name": "Project Management (Diploma / CertIV)", "category": ""}, {"id": "comp_165", "name": "Hydrology, Hydraulics & Flood (degree)", "category": ""}, {"id": "comp_166", "name": "Environmental Management (Diploma / Cert IV)", "category": ""}, {"id": "comp_167", "name": "Electric Vehicles Infrastructure", "category": ""}, {"id": "comp_168", "name": "Electric Vehicles Technician", "category": ""}, {"id": "comp_169", "name": "PCP Levels 1 & 2  (IPAA training) or equivalent", "category": ""}, {"id": "comp_170", "name": "Cert IV in Surveying and Geospacial Information Services", "category": ""}, {"id": "comp_171", "name": "Engineering / Surveying / Geopspacial (degree)", "category": ""}, {"id": "comp_172", "name": "Engineering Civil (degree)", "category": ""}, {"id": "comp_173", "name": "RPEQ", "category": ""}, {"id": "comp_174", "name": "Cert III in Business Administration", "category": ""}, {"id": "comp_175", "name": "Cert III in Boiler making and fabrication", "category": ""}, {"id": "comp_176", "name": "Cert III in Civil Road Construction and Maintenance", "category": ""}, {"id": "comp_177", "name": "Cert III Automotive / Heavy Vehicles", "category": ""}, {"id": "comp_178", "name": "Cert III in Heavy Vehicle Mobile Equip Mech", "category": ""}, {"id": "comp_179", "name": "Cert III in Library & Information Services", "category": ""}, {"id": "comp_180", "name": "Cert III in Parks and Gardens", "category": ""}, {"id": "comp_181", "name": "Cert III in Horticulture", "category": ""}, {"id": "comp_182", "name": "Cert III in Plumbing", "category": ""}, {"id": "comp_183", "name": "Cert III in Water Indust Ops", "category": ""}, {"id": "comp_184", "name": "Cert IV in Civil Construction Supervision", "category": ""}, {"id": "comp_185", "name": "Cert IV in Information Technology", "category": ""}, {"id": "comp_186", "name": "Cert IV in Leadership or Front Line Management or equivalent", "category": ""}, {"id": "comp_187", "name": "Cert IV in Library / Information Services", "category": ""}, {"id": "comp_188", "name": "Cert IV in Local Government", "category": ""}, {"id": "comp_189", "name": "Cert IV in Waste Management", "category": ""}, {"id": "comp_190", "name": "Cert IV Implement land and sea management practices", "category": ""}, {"id": "comp_191", "name": "Cert IV Protect places of cultural significance", "category": ""}, {"id": "comp_192", "name": "Manage Parks & Reserves (Diploma)", "category": ""}, {"id": "comp_193", "name": "Lead Auditors Training", "category": ""}, {"id": "comp_194", "name": "ICAM Incident Investigation certificate", "category": ""}, {"id": "comp_195", "name": "Certificate IV Government Investigations (Regulatory compliance specialisation)", "category": ""}, {"id": "comp_196", "name": "Cert IV in Water Industry Operations", "category": ""}, {"id": "comp_197", "name": "Cert IV in Work Health and Safety", "category": ""}, {"id": "comp_198", "name": "Cert IV in Training & Assessment", "category": ""}, {"id": "comp_199", "name": "Certificate/Degree/Diploma in relevant field", "category": ""}, {"id": "comp_200", "name": "Dipolma of Horticulture", "category": ""}, {"id": "comp_201", "name": "Diploma of Local Government", "category": ""}, {"id": "comp_202", "name": "IPWEAQ Supervisor Course", "category": ""}, {"id": "comp_203", "name": "Registered Professional Association", "category": ""}, {"id": "comp_204", "name": "Australian Certified Economic Developer Program (ACEcD)", "category": ""}, {"id": "comp_205", "name": "CPSS00005 Skill Set - Provide Building Surveying Services for Residential Buildings up to Three Stories", "category": ""}, {"id": "comp_206", "name": "Emergency procedures", "category": "Across Council Knowledge/Skills"}, {"id": "comp_207", "name": "Information Privacy", "category": ""}, {"id": "comp_208", "name": "Safety Induction (General)", "category": ""}, {"id": "comp_209", "name": "Code of Conduct", "category": ""}, {"id": "comp_210", "name": "Psycosocial risks to self and others (Bullying, Harrasment, Respect, Work load, Work-life balance)", "category": ""}, {"id": "comp_211", "name": "Sexual and Gender Base Harrassment", "category": ""}, {"id": "comp_212", "name": "Manual lifting / Hazardous Manual task", "category": ""}, {"id": "comp_213", "name": "Work Station Setup", "category": ""}, {"id": "comp_214", "name": "Cultural Heritage Awareness", "category": ""}, {"id": "comp_215", "name": "Procurement", "category": ""}, {"id": "comp_216", "name": "Authorised Person / Local Government Worker", "category": ""}, {"id": "comp_217", "name": "Risk Management", "category": ""}, {"id": "comp_218", "name": "Record keeping requiements", "category": ""}, {"id": "comp_219", "name": "Project Management", "category": ""}, {"id": "comp_220", "name": "Technical communication skills eg report writing/ specification writing", "category": ""}, {"id": "comp_221", "name": "Contract Managment Training", "category": ""}, {"id": "comp_222", "name": "Performance Conversations", "category": ""}, {"id": "comp_223", "name": "Managing unreasonable conduct", "category": ""}, {"id": "comp_224", "name": "Effective customers interactions/Customer Service", "category": ""}, {"id": "comp_225", "name": "Dealing with grief/grieving customers", "category": ""}, {"id": "comp_226", "name": "Supervisor training", "category": ""}, {"id": "comp_227", "name": "Budgets", "category": ""}, {"id": "comp_228", "name": "IT Skills", "category": ""}], "requirements": {"comp_0": {"role_84": "M(A)"}, "comp_1": {"role_58": "M(A)", "role_59": "M(A)", "role_60": "M(A)", "role_61": "M(A)", "role_62": "M(A)", "role_63": "M(A)", "role_64": "M(A)", "role_94": "M(A)", "role_95": "M(A)", "role_96": "M(A)", "role_101": "M(A)"}, "comp_2": {"role_2": "M(A)", "role_3": "M(A)", "role_4": "M(A)", "role_5": "M(A)", "role_6": "M(A)", "role_7": "M(A)", "role_8": "M(A)", "role_9": "M(A)", "role_10": "M(A)", "role_11": "M(A)", "role_12": "M(A)", "role_13": "M(A)", "role_14": "M(A)", "role_15": "M(A)", "role_16": "M(A)", "role_17": "M(A)", "role_18": "M(A)", "role_19": "M(A)", "role_20": "M(A)", "role_46": "M(A)", "role_58": "M(A)", "role_59": "M(A)", "role_60": "M(A)", "role_61": "M(A)", "role_62": "M(A)", "role_63": "M(A)", "role_86": "M(A)", "role_87": "M(A)", "role_94": "D(A)", "role_97": "D(A)", "role_99": "M(A)", "role_100": "M(A)", "role_102": "M(A)", "role_103": "M(A)", "role_104": "M(A)", "role_105": "M(A)", "role_107": "M(A)"}, "comp_3": {"role_2": "M(A)", "role_3": "D(A)", "role_4": "M(A)", "role_5": "M(A)", "role_6": "M(A)", "role_7": "M(A)", "role_8": "M(A)", "role_9": "M(A)", "role_10": "M(A)", "role_11": "M(A)", "role_12": "M(A)", "role_13": "M(A)", "role_14": "M(A)", "role_15": "M(A)", "role_16": "M(A)", "role_17": "M(A)", "role_18": "M(A)", "role_19": "M(A)", "role_20": "M(A)", "role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_59": "M(A)", "role_60": "M(A)", "role_61": "M(A)", "role_62": "M(A)", "role_63": "M(A)", "role_64": "M(A)", "role_65": "M(A)", "role_68": "M(A)", "role_73": "M(A)", "role_74": "M(A)", "role_75": "M(A)", "role_78": "M(A)", "role_79": "M(A)", "role_80": "M(A)", "role_81": "M(A)", "role_83": "M(A)", "role_84": "M(A)", "role_85": "M(A)", "role_86": "M(A)", "role_87": "M(A)", "role_88": "D(A)", "role_89": "D(A)", "role_90": "D(A)", "role_91": "M(A)", "role_94": "M(A)", "role_95": "M(A)", "role_97": "M(A)", "role_98": "M(A)", "role_99": "M(A)", "role_100": "M(A)", "role_102": "M(A)", "role_103": "M(A)", "role_104": "M(A)", "role_105": "M(A)", "role_107": "M(A)", "role_151": "M(A)"}, "comp_4": {"role_4": "D(A)"}, "comp_5": {"role_4": "D(A)", "role_7": "M(A)", "role_8": "M(A)", "role_9": "M(A)", "role_10": "D(A)", "role_12": "M(A)", "role_15": "M(A)", "role_16": "M(A)", "role_58": "M(A)", "role_60": "D(A)", "role_103": "D(A)"}, "comp_6": {"role_2": "D(A)", "role_5": "M(A)", "role_13": "D(A)", "role_14": "D(A)", "role_17": "M(A)", "role_60": "D(A)", "role_99": "D(A)", "role_100": "D(A)", "role_104": "D(A)"}, "comp_7": {}, "comp_8": {"role_6": "M(A)"}, "comp_9": {}, "comp_10": {}, "comp_11": {}, "comp_12": {}, "comp_13": {"role_4": "D(A)", "role_5": "D(A)", "role_6": "D(A)", "role_7": "D(A)", "role_8": "D(A)"}, "comp_14": {"role_4": "D(A)", "role_5": "D(A)", "role_6": "D(A)", "role_7": "D(A)", "role_8": "D(A)", "role_60": "D(A)"}, "comp_15": {"role_4": "D(A)", "role_5": "D(A)", "role_6": "D(A)", "role_7": "D(A)", "role_8": "D(A)"}, "comp_16": {"role_4": "D(A)", "role_5": "D(A)", "role_6": "D(A)", "role_7": "D(A)", "role_8": "D(A)"}, "comp_17": {"role_4": "D(A)", "role_5": "D(A)", "role_6": "D(A)", "role_7": "D(A)", "role_8": "D(A)"}, "comp_18": {"role_4": "D(A)", "role_5": "D(A)", "role_6": "D(A)", "role_7": "D(A)", "role_8": "D(A)"}, "comp_19": {"role_4": "D(A)", "role_5": "D(A)", "role_6": "D(A)", "role_7": "D(A)", "role_8": "D(A)"}, "comp_20": {"role_4": "D(A)", "role_5": "D(A)", "role_6": "D(A)", "role_7": "D(A)", "role_8": "D(A)", "role_99": "D(A)", "role_100": "D(A)", "role_104": "D(A)"}, "comp_21": {"role_4": "D(A)", "role_5": "D(A)", "role_6": "D(A)", "role_7": "D(A)", "role_8": "D(A)"}, "comp_22": {"role_4": "D(A)", "role_5": "D(A)", "role_6": "D(A)", "role_7": "D(A)", "role_8": "D(A)"}, "comp_23": {"role_4": "D(A)", "role_5": "D(A)", "role_6": "D(A)", "role_7": "D(A)", "role_8": "D(A)"}, "comp_24": {"role_9": "M(A)", "role_15": "M(A)", "role_16": "M(A)", "role_58": "D(A)"}, "comp_25": {"role_9": "M(A)"}, "comp_26": {}, "comp_27": {}, "comp_28": {}, "comp_29": {"role_4": "M(A)", "role_5": "M(A)", "role_6": "M(A)", "role_7": "M(A)", "role_8": "M(A)", "role_9": "M(A)", "role_60": "M(A)", "role_63": "M(A)"}, "comp_30": {}, "comp_31": {"role_46": "D(A)", "role_58": "D(A)", "role_59": "M(A)", "role_104": "D(A)"}, "comp_32": {}, "comp_33": {}, "comp_34": {}, "comp_35": {}, "comp_36": {}, "comp_37": {"role_46": "D(A)", "role_58": "M(A)", "role_59": "M(A)", "role_60": "M(A)", "role_61": "D(A)", "role_62": "M(A)", "role_104": "D(A)"}, "comp_38": {}, "comp_39": {}, "comp_40": {}, "comp_41": {}, "comp_42": {}, "comp_43": {}, "comp_44": {}, "comp_45": {}, "comp_46": {}, "comp_47": {}, "comp_48": {"role_105": "D(A)"}, "comp_49": {}, "comp_50": {}, "comp_51": {}, "comp_52": {}, "comp_53": {}, "comp_54": {"role_102": "D(A)", "role_105": "D(A)"}, "comp_55": {}, "comp_56": {}, "comp_57": {}, "comp_58": {}, "comp_59": {"role_2": "M(A)", "role_60": "D(A)"}, "comp_60": {"role_102": "D(A)", "role_105": "D(A)"}, "comp_61": {"role_102": "D(A)", "role_105": "D(A)"}, "comp_62": {}, "comp_63": {}, "comp_64": {}, "comp_65": {"role_102": "D(A)", "role_103": "M(A)", "role_105": "D(A)"}, "comp_66": {"role_102": "M(A)"}, "comp_67": {}, "comp_68": {"role_102": "M(A)"}, "comp_69": {}, "comp_70": {}, "comp_71": {}, "comp_72": {}, "comp_73": {}, "comp_74": {}, "comp_75": {"role_102": "M(A)"}, "comp_76": {"role_102": "D(A)"}, "comp_77": {}, "comp_78": {}, "comp_79": {}, "comp_80": {}, "comp_81": {"role_2": "M(A)", "role_102": "D(A)", "role_103": "M(A)", "role_104": "M(A)", "role_105": "D(A)"}, "comp_82": {"role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)"}, "comp_83": {"role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)"}, "comp_84": {}, "comp_85": {"role_58": "M(A)", "role_60": "M(A)", "role_61": "D(A)", "role_62": "M(A)", "role_63": "M(A)", "role_64": "M(A)"}, "comp_86": {"role_58": "M(A)", "role_61": "D(A)", "role_64": "M(A)"}, "comp_87": {"role_61": "D(A)"}, "comp_88": {"role_58": "D(A)", "role_60": "M(A)", "role_61": "D(A)", "role_62": "M(A)", "role_63": "M(A)", "role_64": "M(A)", "role_99": "M(A)"}, "comp_89": {"role_61": "D(A)"}, "comp_90": {}, "comp_91": {}, "comp_92": {"role_58": "D(A)", "role_60": "M(A)", "role_61": "D(A)", "role_62": "M(A)", "role_63": "M(A)", "role_64": "M(A)"}, "comp_93": {"role_58": "D(A)", "role_60": "M(A)", "role_62": "M(A)", "role_64": "M(A)"}, "comp_94": {}, "comp_95": {"role_60": "M(A)", "role_63": "M(A)", "role_64": "D(A)", "role_94": "D(A)", "role_95": "M(A)", "role_97": "M(A)"}, "comp_96": {}, "comp_97": {"role_102": "D(A)", "role_105": "M(A)"}, "comp_98": {"role_60": "M(A)", "role_61": "D(A)", "role_63": "M(A)", "role_64": "D(A)"}, "comp_99": {}, "comp_100": {"role_60": "M(A)", "role_61": "M(A)", "role_62": "M(A)", "role_63": "D(S)", "role_64": "D(A)", "role_99": "M(A)", "role_100": "M(A)"}, "comp_101": {}, "comp_102": {}, "comp_103": {}, "comp_104": {}, "comp_105": {}, "comp_106": {}, "comp_107": {}, "comp_108": {}, "comp_109": {}, "comp_110": {}, "comp_111": {}, "comp_112": {}, "comp_113": {}, "comp_114": {"role_87": "D(A)"}, "comp_115": {"role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_104": "M(A)"}, "comp_116": {}, "comp_117": {"role_86": "D(A)", "role_87": "M(A)"}, "comp_118": {"role_86": "D(A)"}, "comp_119": {}, "comp_120": {}, "comp_121": {}, "comp_122": {}, "comp_123": {}, "comp_124": {}, "comp_125": {}, "comp_126": {}, "comp_127": {"role_102": "M(A)", "role_103": "D(A)"}, "comp_128": {}, "comp_129": {"role_15": "M(A)", "role_16": "M(A)"}, "comp_130": {}, "comp_131": {}, "comp_132": {}, "comp_133": {"role_16": "M(A)"}, "comp_134": {}, "comp_135": {}, "comp_136": {}, "comp_137": {}, "comp_138": {}, "comp_139": {}, "comp_140": {}, "comp_141": {}, "comp_142": {}, "comp_143": {}, "comp_144": {"role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_104": "M(A)"}, "comp_145": {"role_45": "M(A)", "role_47": "M(A)", "role_48": "M(A)"}, "comp_146": {"role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_104": "M(A)"}, "comp_147": {"role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_104": "D(A)"}, "comp_148": {"role_45": "M(A)", "role_47": "M(A)", "role_48": "M(A)"}, "comp_149": {"role_48": "M(A)"}, "comp_150": {"role_48": "M(A)"}, "comp_151": {}, "comp_152": {"role_73": "M(A)"}, "comp_153": {"role_73": "M(A)"}, "comp_154": {"role_78": "M(A)", "role_79": "M(A)", "role_80": "M(A)", "role_81": "D(A)"}, "comp_155": {}, "comp_156": {"role_94": "M(A)", "role_95": "M(A)", "role_97": "M(A)", "role_99": "M(A)", "role_100": "M(A)", "role_102": "M(A)", "role_105": "M(A)"}, "comp_157": {}, "comp_158": {}, "comp_159": {"role_105": "M(A)", "role_107": "M(A)"}, "comp_160": {}, "comp_161": {}, "comp_162": {"role_3": "M(A)"}, "comp_163": {"role_18": "M(A)"}, "comp_164": {"role_79": "D(A)", "role_104": "D(A)", "role_107": "M(A)"}, "comp_165": {}, "comp_166": {}, "comp_167": {}, "comp_168": {}, "comp_169": {}, "comp_170": {"role_19": "M(A)"}, "comp_171": {"role_19": "D(A)"}, "comp_172": {"role_20": "M(A)"}, "comp_173": {"role_20": "D(A)"}, "comp_174": {"role_70": "M(A)", "role_77": "M(A)", "role_90": "D(A)", "role_151": "M(A)", "role_153": "M(A)", "role_154": "M(A)", "role_155": "M(A)"}, "comp_175": {"role_12": "M(A)"}, "comp_176": {"role_9": "M(A)", "role_15": "M(A)", "role_16": "M(A)"}, "comp_177": {"role_2": "M(A)", "role_17": "M(A)"}, "comp_178": {}, "comp_179": {}, "comp_180": {"role_60": "M(A)", "role_63": "M(A)"}, "comp_181": {"role_58": "D(A)", "role_61": "M(A)", "role_62": "M(A)"}, "comp_182": {}, "comp_183": {"role_104": "M(A)"}, "comp_184": {"role_15": "D(A)", "role_16": "D(A)"}, "comp_185": {"role_78": "M(A)", "role_79": "M(A)", "role_80": "M(A)"}, "comp_186": {}, "comp_187": {}, "comp_188": {"role_79": "D(A)"}, "comp_189": {"role_100": "M(A)"}, "comp_190": {}, "comp_191": {}, "comp_192": {"role_60": "D(A)", "role_63": "D(A)"}, "comp_193": {}, "comp_194": {}, "comp_195": {}, "comp_196": {}, "comp_197": {"role_86": "M(A)", "role_91": "M(A)"}, "comp_198": {"role_86": "D(A)", "role_87": "D(A)"}, "comp_199": {"role_65": "M(A)", "role_67": "M(A)", "role_69": "M(A)", "role_70": "M(A)", "role_71": "M(A)", "role_73": "M(A)", "role_74": "M(A)", "role_75": "M(A)", "role_76": "M(A)", "role_77": "M(A)", "role_83": "M(A)", "role_85": "M(A)", "role_87": "M(A)", "role_88": "M(A)", "role_89": "M(A)", "role_90": "D(A)", "role_91": "M(A)", "role_98": "M(A)", "role_102": "M(A)", "role_103": "D(A)", "role_105": "M(A)", "role_152": "D(A)", "role_153": "M(A)", "role_154": "M(A)"}, "comp_200": {"role_60": "D(A)", "role_64": "M(A)"}, "comp_201": {"role_155": "D(A)"}, "comp_202": {}, "comp_203": {"role_77": "M(A)"}, "comp_204": {}, "comp_205": {}, "comp_206": {"role_1": "M(A)", "role_2": "M(A)", "role_3": "M(A)", "role_4": "M(A)", "role_5": "M(A)", "role_6": "M(A)", "role_7": "M(A)", "role_8": "M(A)", "role_9": "M(A)", "role_10": "M(A)", "role_11": "M(A)", "role_12": "M(A)", "role_13": "M(A)", "role_14": "M(A)", "role_15": "M(A)", "role_16": "M(A)", "role_17": "M(A)", "role_18": "M(A)", "role_19": "M(A)", "role_20": "M(A)", "role_21": "M(A)", "role_22": "M(A)", "role_23": "M(A)", "role_24": "M(A)", "role_25": "M(A)", "role_26": "M(A)", "role_27": "M(A)", "role_28": "M(A)", "role_29": "M(A)", "role_30": "M(A)", "role_31": "M(A)", "role_32": "M(A)", "role_33": "M(A)", "role_34": "M(A)", "role_35": "M(A)", "role_36": "M(A)", "role_37": "M(A)", "role_38": "M(A)", "role_39": "M(A)", "role_40": "M(A)", "role_41": "M(A)", "role_42": "M(A)", "role_43": "M(A)", "role_44": "M(A)", "role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_49": "M(A)", "role_50": "M(A)", "role_51": "M(A)", "role_52": "M(A)", "role_53": "M(A)", "role_54": "M(A)", "role_55": "M(A)", "role_56": "M(A)", "role_57": "M(A)", "role_58": "M(A)", "role_59": "M(A)", "role_60": "M(A)", "role_61": "M(A)", "role_62": "M(A)", "role_63": "M(A)", "role_64": "M(A)", "role_65": "M(A)", "role_66": "M(A)", "role_67": "M(A)", "role_68": "M(A)", "role_69": "M(A)", "role_70": "M(A)", "role_71": "M(A)", "role_72": "M(A)", "role_73": "M(A)", "role_74": "M(A)", "role_75": "M(A)", "role_76": "M(A)", "role_77": "M(A)", "role_78": "M(A)", "role_79": "M(A)", "role_80": "M(A)", "role_81": "M(A)", "role_82": "M(A)", "role_83": "M(A)", "role_84": "M(A)", "role_85": "M(A)", "role_86": "M(A)", "role_87": "M(A)", "role_88": "M(A)", "role_89": "M(A)", "role_90": "M(A)", "role_91": "M(A)", "role_92": "M(A)", "role_93": "M(A)", "role_94": "M(A)", "role_95": "M(A)", "role_96": "M(A)", "role_97": "M(A)", "role_98": "M(A)", "role_99": "M(A)", "role_100": "M(A)", "role_101": "M(A)", "role_102": "M(A)", "role_103": "M(A)", "role_104": "M(A)", "role_105": "M(A)", "role_106": "M(A)", "role_107": "M(A)", "role_108": "M(A)", "role_109": "M(A)", "role_110": "M(A)", "role_111": "M(A)", "role_112": "M(A)", "role_113": "M(A)", "role_114": "M(A)", "role_115": "M(A)", "role_116": "M(A)", "role_117": "M(A)", "role_118": "M(A)", "role_119": "M(A)", "role_120": "M(A)", "role_121": "M(A)", "role_122": "M(A)", "role_123": "M(A)", "role_124": "M(A)", "role_125": "M(A)", "role_126": "M(A)", "role_127": "M(A)", "role_128": "M(A)", "role_129": "M(A)", "role_130": "M(A)", "role_131": "M(A)", "role_132": "M(A)", "role_133": "M(A)", "role_134": "M(A)", "role_135": "M(A)", "role_136": "M(A)", "role_137": "M(A)", "role_138": "M(A)", "role_139": "M(A)", "role_140": "M(A)", "role_141": "M(A)", "role_142": "M(A)", "role_143": "M(A)", "role_144": "M(A)", "role_145": "M(A)", "role_146": "M(A)", "role_147": "M(A)", "role_148": "M(A)", "role_149": "M(A)", "role_150": "M(A)", "role_151": "M(A)", "role_152": "M(A)", "role_153": "M(A)", "role_154": "M(A)", "role_155": "M(A)", "role_156": "M(A)"}, "comp_207": {"role_1": "M(A)", "role_2": "M(A)", "role_3": "M(A)", "role_4": "M(A)", "role_5": "M(A)", "role_6": "M(A)", "role_7": "M(A)", "role_8": "M(A)", "role_9": "M(A)", "role_10": "M(A)", "role_11": "M(A)", "role_12": "M(A)", "role_13": "M(A)", "role_14": "M(A)", "role_15": "M(A)", "role_16": "M(A)", "role_17": "M(A)", "role_18": "M(A)", "role_19": "M(A)", "role_20": "M(A)", "role_21": "M(A)", "role_22": "M(A)", "role_23": "M(A)", "role_24": "M(A)", "role_25": "M(A)", "role_26": "M(A)", "role_27": "M(A)", "role_28": "M(A)", "role_29": "M(A)", "role_30": "M(A)", "role_31": "M(A)", "role_32": "M(A)", "role_33": "M(A)", "role_34": "M(A)", "role_35": "M(A)", "role_36": "M(A)", "role_37": "M(A)", "role_38": "M(A)", "role_39": "M(A)", "role_40": "M(A)", "role_41": "M(A)", "role_42": "M(A)", "role_43": "M(A)", "role_44": "M(A)", "role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_49": "M(A)", "role_50": "M(A)", "role_51": "M(A)", "role_52": "M(A)", "role_53": "M(A)", "role_54": "M(A)", "role_55": "M(A)", "role_56": "M(A)", "role_57": "M(A)", "role_58": "M(A)", "role_59": "M(A)", "role_60": "M(A)", "role_61": "M(A)", "role_62": "M(A)", "role_63": "M(A)", "role_64": "M(A)", "role_65": "M(A)", "role_66": "M(A)", "role_67": "M(A)", "role_68": "M(A)", "role_69": "M(A)", "role_70": "M(A)", "role_71": "M(A)", "role_72": "M(A)", "role_73": "M(A)", "role_74": "M(A)", "role_75": "M(A)", "role_76": "M(A)", "role_77": "M(A)", "role_78": "M(A)", "role_79": "M(A)", "role_80": "M(A)", "role_81": "M(A)", "role_82": "M(A)", "role_83": "M(A)", "role_84": "M(A)", "role_85": "M(A)", "role_86": "M(A)", "role_87": "M(A)", "role_88": "M(A)", "role_89": "M(A)", "role_90": "M(A)", "role_91": "M(A)", "role_92": "M(A)", "role_93": "M(A)", "role_94": "M(A)", "role_95": "M(A)", "role_96": "M(A)", "role_97": "M(A)", "role_98": "M(A)", "role_99": "M(A)", "role_100": "M(A)", "role_101": "M(A)", "role_102": "M(A)", "role_103": "M(A)", "role_104": "M(A)", "role_105": "M(A)", "role_106": "M(A)", "role_107": "M(A)", "role_108": "M(A)", "role_109": "M(A)", "role_110": "M(A)", "role_111": "M(A)", "role_112": "M(A)", "role_113": "M(A)", "role_114": "M(A)", "role_115": "M(A)", "role_116": "M(A)", "role_117": "M(A)", "role_118": "M(A)", "role_119": "M(A)", "role_120": "M(A)", "role_121": "M(A)", "role_122": "M(A)", "role_123": "M(A)", "role_124": "M(A)", "role_125": "M(A)", "role_126": "M(A)", "role_127": "M(A)", "role_128": "M(A)", "role_129": "M(A)", "role_130": "M(A)", "role_131": "M(A)", "role_132": "M(A)", "role_133": "M(A)", "role_134": "M(A)", "role_135": "M(A)", "role_136": "M(A)", "role_137": "M(A)", "role_138": "M(A)", "role_139": "M(A)", "role_140": "M(A)", "role_141": "M(A)", "role_142": "M(A)", "role_143": "M(A)", "role_144": "M(A)", "role_145": "M(A)", "role_146": "M(A)", "role_147": "M(A)", "role_148": "M(A)", "role_149": "M(A)", "role_150": "M(A)", "role_151": "M(A)", "role_152": "M(A)", "role_153": "M(A)", "role_154": "M(A)", "role_155": "M(A)", "role_156": "M(A)"}, "comp_208": {"role_1": "M(A)", "role_2": "M(A)", "role_3": "M(A)", "role_4": "M(A)", "role_5": "M(A)", "role_6": "M(A)", "role_7": "M(A)", "role_8": "M(A)", "role_9": "M(A)", "role_10": "M(A)", "role_11": "M(A)", "role_12": "M(A)", "role_13": "M(A)", "role_14": "M(A)", "role_15": "M(A)", "role_16": "M(A)", "role_17": "M(A)", "role_18": "M(A)", "role_19": "M(A)", "role_20": "M(A)", "role_21": "M(A)", "role_22": "M(A)", "role_23": "M(A)", "role_24": "M(A)", "role_25": "M(A)", "role_26": "M(A)", "role_27": "M(A)", "role_28": "M(A)", "role_29": "M(A)", "role_30": "M(A)", "role_31": "M(A)", "role_32": "M(A)", "role_33": "M(A)", "role_34": "M(A)", "role_35": "M(A)", "role_36": "M(A)", "role_37": "M(A)", "role_38": "M(A)", "role_39": "M(A)", "role_40": "M(A)", "role_41": "M(A)", "role_42": "M(A)", "role_43": "M(A)", "role_44": "M(A)", "role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_49": "M(A)", "role_50": "M(A)", "role_51": "M(A)", "role_52": "M(A)", "role_53": "M(A)", "role_54": "M(A)", "role_55": "M(A)", "role_56": "M(A)", "role_57": "M(A)", "role_58": "M(A)", "role_59": "M(A)", "role_60": "M(A)", "role_61": "M(A)", "role_62": "M(A)", "role_63": "M(A)", "role_64": "M(A)", "role_65": "M(A)", "role_66": "M(A)", "role_67": "M(A)", "role_68": "M(A)", "role_69": "M(A)", "role_70": "M(A)", "role_71": "M(A)", "role_72": "M(A)", "role_73": "M(A)", "role_74": "M(A)", "role_75": "M(A)", "role_76": "M(A)", "role_77": "M(A)", "role_78": "M(A)", "role_79": "M(A)", "role_80": "M(A)", "role_81": "M(A)", "role_82": "M(A)", "role_83": "M(A)", "role_84": "M(A)", "role_85": "M(A)", "role_86": "M(A)", "role_87": "M(A)", "role_88": "M(A)", "role_89": "M(A)", "role_90": "M(A)", "role_91": "M(A)", "role_92": "M(A)", "role_93": "M(A)", "role_94": "M(A)", "role_95": "M(A)", "role_96": "M(A)", "role_97": "M(A)", "role_98": "M(A)", "role_99": "M(A)", "role_100": "M(A)", "role_101": "M(A)", "role_102": "M(A)", "role_103": "M(A)", "role_104": "M(A)", "role_105": "M(A)", "role_106": "M(A)", "role_107": "M(A)", "role_108": "M(A)", "role_109": "M(A)", "role_110": "M(A)", "role_111": "M(A)", "role_112": "M(A)", "role_113": "M(A)", "role_114": "M(A)", "role_115": "M(A)", "role_116": "M(A)", "role_117": "M(A)", "role_118": "M(A)", "role_119": "M(A)", "role_120": "M(A)", "role_121": "M(A)", "role_122": "M(A)", "role_123": "M(A)", "role_124": "M(A)", "role_125": "M(A)", "role_126": "M(A)", "role_127": "M(A)", "role_128": "M(A)", "role_129": "M(A)", "role_130": "M(A)", "role_131": "M(A)", "role_132": "M(A)", "role_133": "M(A)", "role_134": "M(A)", "role_135": "M(A)", "role_136": "M(A)", "role_137": "M(A)", "role_138": "M(A)", "role_139": "M(A)", "role_140": "M(A)", "role_141": "M(A)", "role_142": "M(A)", "role_143": "M(A)", "role_144": "M(A)", "role_145": "M(A)", "role_146": "M(A)", "role_147": "M(A)", "role_148": "M(A)", "role_149": "M(A)", "role_150": "M(A)", "role_151": "M(A)", "role_152": "M(A)", "role_153": "M(A)", "role_154": "M(A)", "role_155": "M(A)", "role_156": "M(A)"}, "comp_209": {"role_1": "M(A)", "role_2": "M(A)", "role_3": "M(A)", "role_4": "M(A)", "role_5": "M(A)", "role_6": "M(A)", "role_7": "M(A)", "role_8": "M(A)", "role_9": "M(A)", "role_10": "M(A)", "role_11": "M(A)", "role_12": "M(A)", "role_13": "M(A)", "role_14": "M(A)", "role_15": "M(A)", "role_16": "M(A)", "role_17": "M(A)", "role_18": "M(A)", "role_19": "M(A)", "role_20": "M(A)", "role_21": "M(A)", "role_22": "M(A)", "role_23": "M(A)", "role_24": "M(A)", "role_25": "M(A)", "role_26": "M(A)", "role_27": "M(A)", "role_28": "M(A)", "role_29": "M(A)", "role_30": "M(A)", "role_31": "M(A)", "role_32": "M(A)", "role_33": "M(A)", "role_34": "M(A)", "role_35": "M(A)", "role_36": "M(A)", "role_37": "M(A)", "role_38": "M(A)", "role_39": "M(A)", "role_40": "M(A)", "role_41": "M(A)", "role_42": "M(A)", "role_43": "M(A)", "role_44": "M(A)", "role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_49": "M(A)", "role_50": "M(A)", "role_51": "M(A)", "role_52": "M(A)", "role_53": "M(A)", "role_54": "M(A)", "role_55": "M(A)", "role_56": "M(A)", "role_57": "M(A)", "role_58": "M(A)", "role_59": "M(A)", "role_60": "M(A)", "role_61": "M(A)", "role_62": "M(A)", "role_63": "M(A)", "role_64": "M(A)", "role_65": "M(A)", "role_66": "M(A)", "role_67": "M(A)", "role_68": "M(A)", "role_69": "M(A)", "role_70": "M(A)", "role_71": "M(A)", "role_72": "M(A)", "role_73": "M(A)", "role_74": "M(A)", "role_75": "M(A)", "role_76": "M(A)", "role_77": "M(A)", "role_78": "M(A)", "role_79": "M(A)", "role_80": "M(A)", "role_81": "M(A)", "role_82": "M(A)", "role_83": "M(A)", "role_84": "M(A)", "role_85": "M(A)", "role_86": "M(A)", "role_87": "M(A)", "role_88": "M(A)", "role_89": "M(A)", "role_90": "M(A)", "role_91": "M(A)", "role_92": "M(A)", "role_93": "M(A)", "role_94": "M(A)", "role_95": "M(A)", "role_96": "M(A)", "role_97": "M(A)", "role_98": "M(A)", "role_99": "M(A)", "role_100": "M(A)", "role_101": "M(A)", "role_102": "M(A)", "role_103": "M(A)", "role_104": "M(A)", "role_105": "M(A)", "role_106": "M(A)", "role_107": "M(A)", "role_108": "M(A)", "role_109": "M(A)", "role_110": "M(A)", "role_111": "M(A)", "role_112": "M(A)", "role_113": "M(A)", "role_114": "M(A)", "role_115": "M(A)", "role_116": "M(A)", "role_117": "M(A)", "role_118": "M(A)", "role_119": "M(A)", "role_120": "M(A)", "role_121": "M(A)", "role_122": "M(A)", "role_123": "M(A)", "role_124": "M(A)", "role_125": "M(A)", "role_126": "M(A)", "role_127": "M(A)", "role_128": "M(A)", "role_129": "M(A)", "role_130": "M(A)", "role_131": "M(A)", "role_132": "M(A)", "role_133": "M(A)", "role_134": "M(A)", "role_135": "M(A)", "role_136": "M(A)", "role_137": "M(A)", "role_138": "M(A)", "role_139": "M(A)", "role_140": "M(A)", "role_141": "M(A)", "role_142": "M(A)", "role_143": "M(A)", "role_144": "M(A)", "role_145": "M(A)", "role_146": "M(A)", "role_147": "M(A)", "role_148": "M(A)", "role_149": "M(A)", "role_150": "M(A)", "role_151": "M(A)", "role_152": "M(A)", "role_153": "M(A)", "role_154": "M(A)", "role_155": "M(A)", "role_156": "M(A)"}, "comp_210": {"role_1": "M(A)", "role_2": "M(A)", "role_3": "M(A)", "role_4": "M(A)", "role_5": "M(A)", "role_6": "M(A)", "role_7": "M(A)", "role_8": "M(A)", "role_9": "M(A)", "role_10": "M(A)", "role_11": "M(A)", "role_12": "M(A)", "role_13": "M(A)", "role_14": "M(A)", "role_15": "M(A)", "role_16": "M(A)", "role_17": "M(A)", "role_18": "M(A)", "role_19": "M(A)", "role_20": "M(A)", "role_21": "M(A)", "role_22": "M(A)", "role_23": "M(A)", "role_24": "M(A)", "role_25": "M(A)", "role_26": "M(A)", "role_27": "M(A)", "role_28": "M(A)", "role_29": "M(A)", "role_30": "M(A)", "role_31": "M(A)", "role_32": "M(A)", "role_33": "M(A)", "role_34": "M(A)", "role_35": "M(A)", "role_36": "M(A)", "role_37": "M(A)", "role_38": "M(A)", "role_39": "M(A)", "role_40": "M(A)", "role_41": "M(A)", "role_42": "M(A)", "role_43": "M(A)", "role_44": "M(A)", "role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_49": "M(A)", "role_50": "M(A)", "role_51": "M(A)", "role_52": "M(A)", "role_53": "M(A)", "role_54": "M(A)", "role_55": "M(A)", "role_56": "M(A)", "role_57": "M(A)", "role_58": "M(A)", "role_59": "M(A)", "role_60": "M(A)", "role_61": "M(A)", "role_62": "M(A)", "role_63": "M(A)", "role_64": "M(A)", "role_65": "M(A)", "role_66": "M(A)", "role_67": "M(A)", "role_68": "M(A)", "role_69": "M(A)", "role_70": "M(A)", "role_71": "M(A)", "role_72": "M(A)", "role_73": "M(A)", "role_74": "M(A)", "role_75": "M(A)", "role_76": "M(A)", "role_77": "M(A)", "role_78": "M(A)", "role_79": "M(A)", "role_80": "M(A)", "role_81": "M(A)", "role_82": "M(A)", "role_83": "M(A)", "role_84": "M(A)", "role_85": "M(A)", "role_86": "M(A)", "role_87": "M(A)", "role_88": "M(A)", "role_89": "M(A)", "role_90": "M(A)", "role_91": "M(A)", "role_92": "M(A)", "role_93": "M(A)", "role_94": "M(A)", "role_95": "M(A)", "role_96": "M(A)", "role_97": "M(A)", "role_98": "M(A)", "role_99": "M(A)", "role_100": "M(A)", "role_101": "M(A)", "role_102": "M(A)", "role_103": "M(A)", "role_104": "M(A)", "role_105": "M(A)", "role_106": "M(A)", "role_107": "M(A)", "role_108": "M(A)", "role_109": "M(A)", "role_110": "M(A)", "role_111": "M(A)", "role_112": "M(A)", "role_113": "M(A)", "role_114": "M(A)", "role_115": "M(A)", "role_116": "M(A)", "role_117": "M(A)", "role_118": "M(A)", "role_119": "M(A)", "role_120": "M(A)", "role_121": "M(A)", "role_122": "M(A)", "role_123": "M(A)", "role_124": "M(A)", "role_125": "M(A)", "role_126": "M(A)", "role_127": "M(A)", "role_128": "M(A)", "role_129": "M(A)", "role_130": "M(A)", "role_131": "M(A)", "role_132": "M(A)", "role_133": "M(A)", "role_134": "M(A)", "role_135": "M(A)", "role_136": "M(A)", "role_137": "M(A)", "role_138": "M(A)", "role_139": "M(A)", "role_140": "M(A)", "role_141": "M(A)", "role_142": "M(A)", "role_143": "M(A)", "role_144": "M(A)", "role_145": "M(A)", "role_146": "M(A)", "role_147": "M(A)", "role_148": "M(A)", "role_149": "M(A)", "role_150": "M(A)", "role_151": "M(A)", "role_152": "M(A)", "role_153": "M(A)", "role_154": "M(A)", "role_155": "M(A)", "role_156": "M(A)"}, "comp_211": {"role_1": "M(A)", "role_2": "M(A)", "role_3": "M(A)", "role_4": "M(A)", "role_5": "M(A)", "role_6": "M(A)", "role_7": "M(A)", "role_8": "M(A)", "role_9": "M(A)", "role_10": "M(A)", "role_11": "M(A)", "role_12": "M(A)", "role_13": "M(A)", "role_14": "M(A)", "role_15": "M(A)", "role_16": "M(A)", "role_17": "M(A)", "role_18": "M(A)", "role_19": "M(A)", "role_20": "M(A)", "role_21": "M(A)", "role_22": "M(A)", "role_23": "M(A)", "role_24": "M(A)", "role_25": "M(A)", "role_26": "M(A)", "role_27": "M(A)", "role_28": "M(A)", "role_29": "M(A)", "role_30": "M(A)", "role_31": "M(A)", "role_32": "M(A)", "role_33": "M(A)", "role_34": "M(A)", "role_35": "M(A)", "role_36": "M(A)", "role_37": "M(A)", "role_38": "M(A)", "role_39": "M(A)", "role_40": "M(A)", "role_41": "M(A)", "role_42": "M(A)", "role_43": "M(A)", "role_44": "M(A)", "role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_49": "M(A)", "role_50": "M(A)", "role_51": "M(A)", "role_52": "M(A)", "role_53": "M(A)", "role_54": "M(A)", "role_55": "M(A)", "role_56": "M(A)", "role_57": "M(A)", "role_58": "M(A)", "role_59": "M(A)", "role_60": "M(A)", "role_61": "M(A)", "role_62": "M(A)", "role_63": "M(A)", "role_64": "M(A)", "role_65": "M(A)", "role_66": "M(A)", "role_67": "M(A)", "role_68": "M(A)", "role_69": "M(A)", "role_70": "M(A)", "role_71": "M(A)", "role_72": "M(A)", "role_73": "M(A)", "role_74": "M(A)", "role_75": "M(A)", "role_76": "M(A)", "role_77": "M(A)", "role_78": "M(A)", "role_79": "M(A)", "role_80": "M(A)", "role_81": "M(A)", "role_82": "M(A)", "role_83": "M(A)", "role_84": "M(A)", "role_85": "M(A)", "role_86": "M(A)", "role_87": "M(A)", "role_88": "M(A)", "role_89": "M(A)", "role_90": "M(A)", "role_91": "M(A)", "role_92": "M(A)", "role_93": "M(A)", "role_94": "M(A)", "role_95": "M(A)", "role_96": "M(A)", "role_97": "M(A)", "role_98": "M(A)", "role_99": "M(A)", "role_100": "M(A)", "role_101": "M(A)", "role_102": "M(A)", "role_103": "M(A)", "role_104": "M(A)", "role_105": "M(A)", "role_106": "M(A)", "role_107": "M(A)", "role_108": "M(A)", "role_109": "M(A)", "role_110": "M(A)", "role_111": "M(A)", "role_112": "M(A)", "role_113": "M(A)", "role_114": "M(A)", "role_115": "M(A)", "role_116": "M(A)", "role_117": "M(A)", "role_118": "M(A)", "role_119": "M(A)", "role_120": "M(A)", "role_121": "M(A)", "role_122": "M(A)", "role_123": "M(A)", "role_124": "M(A)", "role_125": "M(A)", "role_126": "M(A)", "role_127": "M(A)", "role_128": "M(A)", "role_129": "M(A)", "role_130": "M(A)", "role_131": "M(A)", "role_132": "M(A)", "role_133": "M(A)", "role_134": "M(A)", "role_135": "M(A)", "role_136": "M(A)", "role_137": "M(A)", "role_138": "M(A)", "role_139": "M(A)", "role_140": "M(A)", "role_141": "M(A)", "role_142": "M(A)", "role_143": "M(A)", "role_144": "M(A)", "role_145": "M(A)", "role_146": "M(A)", "role_147": "M(A)", "role_148": "M(A)", "role_149": "M(A)", "role_150": "M(A)", "role_151": "M(A)", "role_152": "M(A)", "role_153": "M(A)", "role_154": "M(A)", "role_155": "M(A)", "role_156": "M(A)"}, "comp_212": {"role_1": "M(A)", "role_2": "M(A)", "role_3": "M(A)", "role_4": "M(A)", "role_5": "M(A)", "role_6": "M(A)", "role_7": "M(A)", "role_8": "M(A)", "role_9": "M(A)", "role_10": "M(A)", "role_11": "M(A)", "role_12": "M(A)", "role_13": "M(A)", "role_14": "M(A)", "role_15": "M(A)", "role_16": "M(A)", "role_17": "M(A)", "role_18": "M(A)", "role_19": "M(A)", "role_20": "M(A)", "role_21": "M(A)", "role_22": "M(A)", "role_23": "M(A)", "role_24": "M(A)", "role_25": "M(A)", "role_26": "M(A)", "role_27": "M(A)", "role_28": "M(A)", "role_29": "M(A)", "role_30": "M(A)", "role_31": "M(A)", "role_32": "M(A)", "role_33": "M(A)", "role_34": "M(A)", "role_35": "M(A)", "role_36": "M(A)", "role_37": "M(A)", "role_38": "M(A)", "role_39": "M(A)", "role_40": "M(A)", "role_41": "M(A)", "role_42": "M(A)", "role_43": "M(A)", "role_44": "M(A)", "role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_49": "M(A)", "role_50": "M(A)", "role_51": "M(A)", "role_52": "M(A)", "role_53": "M(A)", "role_54": "M(A)", "role_55": "M(A)", "role_56": "M(A)", "role_57": "M(A)", "role_58": "M(A)", "role_59": "M(A)", "role_60": "M(A)", "role_61": "M(A)", "role_62": "M(A)", "role_63": "M(A)", "role_64": "M(A)", "role_65": "M(A)", "role_66": "M(A)", "role_67": "M(A)", "role_68": "M(A)", "role_69": "M(A)", "role_70": "M(A)", "role_71": "M(A)", "role_72": "M(A)", "role_73": "M(A)", "role_74": "M(A)", "role_75": "M(A)", "role_76": "M(A)", "role_77": "M(A)", "role_78": "M(A)", "role_79": "M(A)", "role_80": "M(A)", "role_81": "M(A)", "role_82": "M(A)", "role_83": "M(A)", "role_84": "M(A)", "role_85": "M(A)", "role_86": "M(A)", "role_87": "M(A)", "role_88": "M(A)", "role_89": "M(A)", "role_90": "M(A)", "role_91": "M(A)", "role_92": "M(A)", "role_93": "M(A)", "role_94": "M(A)", "role_95": "M(A)", "role_96": "M(A)", "role_97": "M(A)", "role_98": "M(A)", "role_99": "M(A)", "role_100": "M(A)", "role_101": "M(A)", "role_102": "M(A)", "role_103": "M(A)", "role_104": "M(A)", "role_105": "M(A)", "role_106": "M(A)", "role_107": "M(A)", "role_108": "M(A)", "role_109": "M(A)", "role_110": "M(A)", "role_111": "M(A)", "role_112": "M(A)", "role_113": "M(A)", "role_114": "M(A)", "role_115": "M(A)", "role_116": "M(A)", "role_117": "M(A)", "role_118": "M(A)", "role_119": "M(A)", "role_120": "M(A)", "role_121": "M(A)", "role_122": "M(A)", "role_123": "M(A)", "role_124": "M(A)", "role_125": "M(A)", "role_126": "M(A)", "role_127": "M(A)", "role_128": "M(A)", "role_129": "M(A)", "role_130": "M(A)", "role_131": "M(A)", "role_132": "M(A)", "role_133": "M(A)", "role_134": "M(A)", "role_135": "M(A)", "role_136": "M(A)", "role_137": "M(A)", "role_138": "M(A)", "role_139": "M(A)", "role_140": "M(A)", "role_141": "M(A)", "role_142": "M(A)", "role_143": "M(A)", "role_144": "M(A)", "role_145": "M(A)", "role_146": "M(A)", "role_147": "M(A)", "role_148": "M(A)", "role_149": "M(A)", "role_150": "M(A)", "role_151": "M(A)", "role_152": "M(A)", "role_153": "M(A)", "role_154": "M(A)", "role_155": "M(A)", "role_156": "M(A)"}, "comp_213": {"role_1": "M(A)", "role_2": "M(A)", "role_3": "M(A)", "role_4": "M(A)", "role_5": "M(A)", "role_6": "M(A)", "role_7": "M(A)", "role_8": "M(A)", "role_9": "M(A)", "role_10": "M(A)", "role_11": "M(A)", "role_12": "M(A)", "role_13": "M(A)", "role_14": "M(A)", "role_15": "M(A)", "role_16": "M(A)", "role_17": "M(A)", "role_18": "M(A)", "role_19": "M(A)", "role_20": "M(A)", "role_21": "M(A)", "role_22": "M(A)", "role_23": "M(A)", "role_24": "M(A)", "role_25": "M(A)", "role_26": "M(A)", "role_27": "M(A)", "role_28": "M(A)", "role_29": "M(A)", "role_30": "M(A)", "role_31": "M(A)", "role_32": "M(A)", "role_33": "M(A)", "role_34": "M(A)", "role_35": "M(A)", "role_36": "M(A)", "role_37": "M(A)", "role_38": "M(A)", "role_39": "M(A)", "role_40": "M(A)", "role_41": "M(A)", "role_42": "M(A)", "role_43": "M(A)", "role_44": "M(A)", "role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_49": "M(A)", "role_50": "M(A)", "role_51": "M(A)", "role_52": "M(A)", "role_53": "M(A)", "role_54": "M(A)", "role_55": "M(A)", "role_56": "M(A)", "role_57": "M(A)", "role_58": "M(A)", "role_59": "M(A)", "role_60": "M(A)", "role_61": "M(A)", "role_62": "M(A)", "role_63": "M(A)", "role_64": "M(A)", "role_65": "M(A)", "role_66": "M(A)", "role_67": "M(A)", "role_68": "M(A)", "role_69": "M(A)", "role_70": "M(A)", "role_71": "M(A)", "role_72": "M(A)", "role_73": "M(A)", "role_74": "M(A)", "role_75": "M(A)", "role_76": "M(A)", "role_77": "M(A)", "role_78": "M(A)", "role_79": "M(A)", "role_80": "M(A)", "role_81": "M(A)", "role_82": "M(A)", "role_83": "M(A)", "role_84": "M(A)", "role_85": "M(A)", "role_86": "M(A)", "role_87": "M(A)", "role_88": "M(A)", "role_89": "M(A)", "role_90": "M(A)", "role_91": "M(A)", "role_92": "M(A)", "role_93": "M(A)", "role_94": "M(A)", "role_95": "M(A)", "role_96": "M(A)", "role_97": "M(A)", "role_98": "M(A)", "role_99": "M(A)", "role_100": "M(A)", "role_101": "M(A)", "role_102": "M(A)", "role_103": "M(A)", "role_104": "M(A)", "role_105": "M(A)", "role_106": "M(A)", "role_107": "M(A)", "role_108": "M(A)", "role_109": "M(A)", "role_110": "M(A)", "role_111": "M(A)", "role_112": "M(A)", "role_113": "M(A)", "role_114": "M(A)", "role_115": "M(A)", "role_116": "M(A)", "role_117": "M(A)", "role_118": "M(A)", "role_119": "M(A)", "role_120": "M(A)", "role_121": "M(A)", "role_122": "M(A)", "role_123": "M(A)", "role_124": "M(A)", "role_125": "M(A)", "role_126": "M(A)", "role_127": "M(A)", "role_128": "M(A)", "role_129": "M(A)", "role_130": "M(A)", "role_131": "M(A)", "role_132": "M(A)", "role_133": "M(A)", "role_134": "M(A)", "role_135": "M(A)", "role_136": "M(A)", "role_137": "M(A)", "role_138": "M(A)", "role_139": "M(A)", "role_140": "M(A)", "role_141": "M(A)", "role_142": "M(A)", "role_143": "M(A)", "role_144": "M(A)", "role_145": "M(A)", "role_146": "M(A)", "role_147": "M(A)", "role_148": "M(A)", "role_149": "M(A)", "role_150": "M(A)", "role_151": "M(A)", "role_152": "M(A)", "role_153": "M(A)", "role_154": "M(A)", "role_155": "M(A)", "role_156": "M(A)"}, "comp_214": {"role_1": "M(A)", "role_2": "M(A)", "role_3": "M(A)", "role_4": "M(A)", "role_5": "M(A)", "role_6": "M(A)", "role_7": "M(A)", "role_8": "M(A)", "role_9": "M(A)", "role_10": "M(A)", "role_11": "M(A)", "role_12": "M(A)", "role_13": "M(A)", "role_14": "M(A)", "role_15": "M(A)", "role_16": "M(A)", "role_17": "M(A)", "role_18": "M(A)", "role_19": "M(A)", "role_20": "M(A)", "role_21": "M(A)", "role_22": "M(A)", "role_23": "M(A)", "role_24": "M(A)", "role_25": "M(A)", "role_26": "M(A)", "role_27": "M(A)", "role_28": "M(A)", "role_29": "M(A)", "role_30": "M(A)", "role_31": "M(A)", "role_32": "M(A)", "role_33": "M(A)", "role_34": "M(A)", "role_35": "M(A)", "role_36": "M(A)", "role_37": "M(A)", "role_38": "M(A)", "role_39": "M(A)", "role_40": "M(A)", "role_41": "M(A)", "role_42": "M(A)", "role_43": "M(A)", "role_44": "M(A)", "role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_49": "M(A)", "role_50": "M(A)", "role_51": "M(A)", "role_52": "M(A)", "role_53": "M(A)", "role_54": "M(A)", "role_55": "M(A)", "role_56": "M(A)", "role_57": "M(A)", "role_58": "M(A)", "role_59": "M(A)", "role_60": "M(A)", "role_61": "M(A)", "role_62": "M(A)", "role_63": "M(A)", "role_64": "M(A)", "role_65": "M(A)", "role_66": "M(A)", "role_67": "M(A)", "role_68": "M(A)", "role_69": "M(A)", "role_70": "M(A)", "role_71": "M(A)", "role_72": "M(A)", "role_73": "M(A)", "role_74": "M(A)", "role_75": "M(A)", "role_76": "M(A)", "role_77": "M(A)", "role_78": "M(A)", "role_79": "M(A)", "role_80": "M(A)", "role_81": "M(A)", "role_82": "M(A)", "role_83": "M(A)", "role_84": "M(A)", "role_85": "M(A)", "role_86": "M(A)", "role_87": "M(A)", "role_88": "M(A)", "role_89": "M(A)", "role_90": "M(A)", "role_91": "M(A)", "role_92": "M(A)", "role_93": "M(A)", "role_94": "M(A)", "role_95": "M(A)", "role_96": "M(A)", "role_97": "M(A)", "role_98": "M(A)", "role_99": "M(A)", "role_100": "M(A)", "role_101": "M(A)", "role_102": "M(A)", "role_103": "M(A)", "role_104": "M(A)", "role_105": "M(A)", "role_106": "M(A)", "role_107": "M(A)", "role_108": "M(A)", "role_109": "M(A)", "role_110": "M(A)", "role_111": "M(A)", "role_112": "M(A)", "role_113": "M(A)", "role_114": "M(A)", "role_115": "M(A)", "role_116": "M(A)", "role_117": "M(A)", "role_118": "M(A)", "role_119": "M(A)", "role_120": "M(A)", "role_121": "M(A)", "role_122": "M(A)", "role_123": "M(A)", "role_124": "M(A)", "role_125": "M(A)", "role_126": "M(A)", "role_127": "M(A)", "role_128": "M(A)", "role_129": "M(A)", "role_130": "M(A)", "role_131": "M(A)", "role_132": "M(A)", "role_133": "M(A)", "role_134": "M(A)", "role_135": "M(A)", "role_136": "M(A)", "role_137": "M(A)", "role_138": "M(A)", "role_139": "M(A)", "role_140": "M(A)", "role_141": "M(A)", "role_142": "M(A)", "role_143": "M(A)", "role_144": "M(A)", "role_145": "M(A)", "role_146": "M(A)", "role_147": "M(A)", "role_148": "M(A)", "role_149": "M(A)", "role_150": "M(A)", "role_151": "M(A)", "role_152": "M(A)", "role_153": "M(A)", "role_154": "M(A)", "role_155": "M(A)", "role_156": "M(A)"}, "comp_215": {"role_1": "M(A)", "role_2": "M(A)", "role_3": "M(A)", "role_4": "M(A)", "role_5": "M(A)", "role_6": "M(A)", "role_7": "M(A)", "role_8": "M(A)", "role_9": "M(A)", "role_10": "M(A)", "role_11": "M(A)", "role_12": "M(A)", "role_13": "M(A)", "role_14": "M(A)", "role_15": "M(A)", "role_16": "M(A)", "role_17": "M(A)", "role_18": "M(A)", "role_19": "M(A)", "role_20": "M(A)", "role_21": "M(A)", "role_22": "M(A)", "role_23": "M(A)", "role_24": "M(A)", "role_25": "M(A)", "role_26": "M(A)", "role_27": "M(A)", "role_28": "M(A)", "role_29": "M(A)", "role_30": "M(A)", "role_31": "M(A)", "role_32": "M(A)", "role_33": "M(A)", "role_34": "M(A)", "role_35": "M(A)", "role_36": "M(A)", "role_37": "M(A)", "role_38": "M(A)", "role_39": "M(A)", "role_40": "M(A)", "role_41": "M(A)", "role_42": "M(A)", "role_43": "M(A)", "role_44": "M(A)", "role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_49": "M(A)", "role_50": "M(A)", "role_51": "M(A)", "role_52": "M(A)", "role_53": "M(A)", "role_54": "M(A)", "role_55": "M(A)", "role_56": "M(A)", "role_57": "M(A)", "role_58": "M(A)", "role_59": "M(A)", "role_60": "M(A)", "role_61": "M(A)", "role_62": "M(A)", "role_63": "M(A)", "role_64": "M(A)", "role_65": "M(A)", "role_66": "M(A)", "role_67": "M(A)", "role_68": "M(A)", "role_69": "M(A)", "role_70": "M(A)", "role_71": "M(A)", "role_72": "M(A)", "role_73": "M(A)", "role_74": "M(A)", "role_75": "M(A)", "role_76": "M(A)", "role_77": "M(A)", "role_78": "M(A)", "role_79": "M(A)", "role_80": "M(A)", "role_81": "M(A)", "role_82": "M(A)", "role_83": "M(A)", "role_84": "M(A)", "role_85": "M(A)", "role_86": "M(A)", "role_87": "M(A)", "role_88": "M(A)", "role_89": "M(A)", "role_90": "M(A)", "role_91": "M(A)", "role_92": "M(A)", "role_93": "M(A)", "role_94": "M(A)", "role_95": "M(A)", "role_96": "M(A)", "role_97": "M(A)", "role_98": "M(A)", "role_99": "M(A)", "role_100": "M(A)", "role_101": "M(A)", "role_102": "M(A)", "role_103": "M(A)", "role_104": "M(A)", "role_105": "M(A)", "role_106": "M(A)", "role_107": "M(A)", "role_108": "M(A)", "role_109": "M(A)", "role_110": "M(A)", "role_111": "M(A)", "role_112": "M(A)", "role_113": "M(A)", "role_114": "M(A)", "role_115": "M(A)", "role_116": "M(A)", "role_117": "M(A)", "role_118": "M(A)", "role_119": "M(A)", "role_120": "M(A)", "role_121": "M(A)", "role_122": "M(A)", "role_123": "M(A)", "role_124": "M(A)", "role_125": "M(A)", "role_126": "M(A)", "role_127": "M(A)", "role_128": "M(A)", "role_129": "M(A)", "role_130": "M(A)", "role_131": "M(A)", "role_132": "M(A)", "role_133": "M(A)", "role_134": "M(A)", "role_135": "M(A)", "role_136": "M(A)", "role_137": "M(A)", "role_138": "M(A)", "role_139": "M(A)", "role_140": "M(A)", "role_141": "M(A)", "role_142": "M(A)", "role_143": "M(A)", "role_144": "M(A)", "role_145": "M(A)", "role_146": "M(A)", "role_147": "M(A)", "role_148": "M(A)", "role_149": "M(A)", "role_150": "M(A)", "role_151": "M(A)", "role_152": "M(A)", "role_153": "M(A)", "role_154": "M(A)", "role_155": "M(A)", "role_156": "M(A)"}, "comp_216": {}, "comp_217": {"role_87": "D(A)", "role_88": "M(A)", "role_152": "M(A)", "role_154": "M(A)"}, "comp_218": {"role_1": "M(A)", "role_150": "M(A)", "role_151": "M(A)", "role_152": "D(A)", "role_153": "D(A)"}, "comp_219": {"role_74": "D(A)", "role_85": "M(A)", "role_98": "M(A)", "role_154": "M(A)"}, "comp_220": {"role_71": "M(A)", "role_74": "D(A)", "role_75": "M(A)", "role_76": "M(A)", "role_77": "M(A)", "role_79": "D(A)", "role_84": "M(A)", "role_87": "M(A)", "role_91": "M(A)", "role_98": "M(A)", "role_148": "M(A)", "role_151": "M(A)", "role_154": "M(A)", "role_155": "M(A)"}, "comp_221": {"role_75": "M(A)"}, "comp_222": {}, "comp_223": {}, "comp_224": {"role_1": "M(A)", "role_45": "D(A)", "role_47": "D(A)", "role_65": "D(A)", "role_66": "D(A)", "role_67": "M(A)", "role_73": "M(A)", "role_81": "M(A)", "role_83": "M(A)", "role_86": "M(A)", "role_87": "M(A)", "role_88": "M(A)", "role_89": "M(A)", "role_90": "D(A)", "role_93": "M(A)", "role_97": "M(A)", "role_98": "D(A)", "role_100": "M(A)", "role_102": "M(A)", "role_104": "D(A)", "role_153": "D(A)", "role_154": "M(A)"}, "comp_225": {}, "comp_226": {"role_60": "M(A)", "role_63": "M(A)", "role_64": "M(A)", "role_76": "D(A)", "role_77": "M(A)"}, "comp_227": {"role_63": "M(A)", "role_67": "D(A)", "role_68": "M(A)", "role_69": "M(A)", "role_70": "M(A)", "role_71": "M(A)", "role_73": "M(A)", "role_74": "M(A)", "role_76": "M(A)", "role_77": "M(A)", "role_83": "M(A)", "role_98": "M(A)"}, "comp_228": {"role_45": "M(A)", "role_46": "M(A)", "role_47": "M(A)", "role_48": "M(A)", "role_60": "D(A)", "role_64": "M(A)", "role_65": "M(A)", "role_66": "M(A)", "role_67": "M(A)", "role_68": "M(A)", "role_69": "M(A)", "role_70": "M(A)", "role_71": "M(A)", "role_73": "M(A)", "role_74": "M(A)", "role_75": "M(A)", "role_76": "M(A)", "role_78": "M(A)", "role_79": "M(A)", "role_80": "M(A)", "role_81": "M(A)", "role_83": "M(A)", "role_84": "M(A)", "role_85": "M(A)", "role_87": "M(A)", "role_88": "M(A)", "role_89": "M(A)", "role_90": "M(A)", "role_91": "M(A)", "role_93": "M(A)", "role_98": "M(A)", "role_103": "M(A)", "role_104": "D(A)", "role_105": "M(A)", "role_107": "M(A)", "role_148": "M(A)", "role_150": "M(A)", "role_151": "M(A)", "role_152": "D(A)", "role_153": "M(A)", "role_154": "M(A)", "role_155": "M(A)"}}};
    </script>
    <script type="text/babel">
const { useState, useEffect, useMemo } = React;

const INITIAL_PEOPLE = [
    { id: 'p1', name: 'John Smith', roleId: 'role_1', department: 'Fleet & Civil Works', email: 'john.smith@cookshire.qld.gov.au' },
    { id: 'p2', name: 'Sarah Johnson', roleId: 'role_2', department: 'Fleet & Civil Works', email: 'sarah.johnson@cookshire.qld.gov.au' },
];

const INITIAL_COURSES = [
    { id: 'course_1', name: 'White Card - Construction Induction', providerType: 'external', provider: 'SafeWork QLD', recertificationMonths: null, internalVerificationAllowed: false, cost: 120, duration: '1 day', notes: 'Required for all construction workers' },
    { id: 'course_2', name: 'First Aid Certificate', providerType: 'external', provider: 'St Johns Ambulance', recertificationMonths: 36, internalVerificationAllowed: false, cost: 180, duration: '2 days', notes: 'CPR and First Aid training' },
    { id: 'course_3', name: 'Forklift Operation', providerType: 'internal', provider: 'Cook Shire Council', recertificationMonths: 60, internalVerificationAllowed: true, internalVerifier: 'Workshop Foreman', cost: 0, duration: '3 days', notes: 'Internal training' },
    { id: 'course_4', name: 'Manual Handling', providerType: 'internal', provider: 'Cook Shire Council', recertificationMonths: 24, internalVerificationAllowed: true, internalVerifier: 'WHS Manager', cost: 0, duration: '4 hours', notes: 'Refresher every 2 years' },
];

function Modal({ isOpen, onClose, title, children, size = 'md' }) {
    if (!isOpen) return null;
    const sizeClasses = { 'sm': 'max-w-md', 'md': 'max-w-2xl', 'lg': 'max-w-4xl', 'xl': 'max-w-6xl' };
    return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" onClick={onClose}>
            <div className={`bg-white rounded-lg shadow-xl p-6 ${sizeClasses[size]} w-full max-h-[90vh] overflow-y-auto`} onClick={(e) => e.stopPropagation()}>
                <div className="flex justify-between items-center mb-4">
                    <h3 className="text-xl font-bold">{title}</h3>
                    <button onClick={onClose} className="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
                {children}
            </div>
        </div>
    );
}

function RequirementModal({ isOpen, onClose, onSave, competency, role, currentRequirement }) {
    const [requirement, setRequirement] = useState(currentRequirement || '');
    useEffect(() => { setRequirement(currentRequirement || ''); }, [currentRequirement, isOpen]);
    const handleSubmit = (e) => { e.preventDefault(); onSave(competency.id, role.id, requirement); onClose(); };
    return (
        <Modal isOpen={isOpen} onClose={onClose} title="Edit Requirement" size="sm">
            <div className="mb-4 text-sm">
                <p><strong>Competency:</strong> {competency?.name}</p>
                <p><strong>Role:</strong> {role?.name}</p>
            </div>
            <form onSubmit={handleSubmit} className="space-y-4">
                <div>
                    <label className="block text-sm font-medium mb-2">Requirement Level</label>
                    <select className="w-full px-3 py-2 border rounded-lg" value={requirement} onChange={(e) => setRequirement(e.target.value)}>
                        <option value="">None</option>
                        <option value="M(A)">M(A) - Mandatory (All)</option>
                        <option value="M(S)">M(S) - Mandatory (Specific)</option>
                        <option value="D(A)">D(A) - Desirable (All)</option>
                        <option value="D(S)">D(S) - Desirable (Specific)</option>
                        <option value="LM">LM - License Mandatory</option>
                    </select>
                </div>
                <div className="flex gap-3">
                    <button type="submit" className="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">Save</button>
                    <button type="button" onClick={onClose} className="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
                </div>
            </form>
        </Modal>
    );
}

function CourseModal({ isOpen, onClose, onSave, existingCourse, competencies }) {
    const [formData, setFormData] = useState({ name: '', providerType: 'external', provider: '', recertificationMonths: '', internalVerificationAllowed: false, internalVerifier: '', cost: '', duration: '', notes: '', websiteUrl: '', contactPhone: '', contactEmail: '', linkedCompetencies: [] });
    const [extracting, setExtracting] = useState(false);
    const [extractError, setExtractError] = useState('');
    
    useEffect(() => {
        if (existingCourse) { 
            setFormData({
                ...existingCourse,
                linkedCompetencies: existingCourse.linkedCompetencies || []
            }); 
        }
        else { setFormData({ name: '', providerType: 'external', provider: '', recertificationMonths: '', internalVerificationAllowed: false, internalVerifier: '', cost: '', duration: '', notes: '', websiteUrl: '', contactPhone: '', contactEmail: '', linkedCompetencies: [] }); }
        setExtractError('');
    }, [existingCourse, isOpen]);
    
    const extractContactDetails = async () => {
        if (!formData.websiteUrl) {
            setExtractError('Please enter a website URL first');
            return;
        }
        
        setExtracting(true);
        setExtractError('');
        
        try {
            // Try to fetch the webpage
            const response = await fetch(formData.websiteUrl);
            const html = await response.text();
            
            // Simple regex patterns for contact extraction
            const emailPattern = /([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi;
            const phonePattern = /(\+?61\s?[2-478](?:[\s]?\d){8}|0[2-478](?:[\s]?\d){8}|\(0[2-478]\)[\s]?\d{4}[\s]?\d{4}|04\d{2}[\s]?\d{3}[\s]?\d{3})/gi;
            
            const emails = html.match(emailPattern) || [];
            const phones = html.match(phonePattern) || [];
            
            // Filter out common non-contact emails
            const validEmails = emails.filter(e => 
                !e.includes('example.com') && 
                !e.includes('test.com') && 
                !e.includes('placeholder') &&
                !e.includes('javascript:')
            );
            
            if (validEmails.length > 0 || phones.length > 0) {
                setFormData({
                    ...formData,
                    contactEmail: validEmails[0] || formData.contactEmail,
                    contactPhone: phones[0] || formData.contactPhone
                });
                setExtractError('');
            } else {
                setExtractError('No contact details found on page. Please enter manually.');
            }
        } catch (error) {
            setExtractError('Could not fetch website. Please enter contact details manually.');
        } finally {
            setExtracting(false);
        }
    };
    
    const handleSubmit = (e) => {
        e.preventDefault();
        onSave({ ...formData, id: existingCourse?.id || 'course_' + Date.now(), recertificationMonths: formData.recertificationMonths ? parseInt(formData.recertificationMonths) : null, cost: formData.cost ? parseFloat(formData.cost) : 0 });
        onClose();
    };
    
    const handleCompetencyToggle = (compId) => {
        const current = formData.linkedCompetencies || [];
        if (current.includes(compId)) {
            setFormData({...formData, linkedCompetencies: current.filter(c => c !== compId)});
        } else {
            setFormData({...formData, linkedCompetencies: [...current, compId]});
        }
    };
    
    return (
        <Modal isOpen={isOpen} onClose={onClose} title={existingCourse ? 'Edit Course' : 'Add Course'} size="lg">
            <form onSubmit={handleSubmit} className="space-y-4">
                <div className="grid grid-cols-2 gap-4">
                    <div className="col-span-2"><label className="block text-sm font-medium mb-1">Course Name *</label><input type="text" required className="w-full px-3 py-2 border rounded-lg" value={formData.name} onChange={(e) => setFormData({...formData, name: e.target.value})} /></div>
                    <div><label className="block text-sm font-medium mb-1">Provider Type *</label><select required className="w-full px-3 py-2 border rounded-lg" value={formData.providerType} onChange={(e) => setFormData({...formData, providerType: e.target.value})}><option value="internal">Internal</option><option value="external">External</option></select></div>
                    <div><label className="block text-sm font-medium mb-1">Provider Name *</label><input type="text" required className="w-full px-3 py-2 border rounded-lg" value={formData.provider} onChange={(e) => setFormData({...formData, provider: e.target.value})} /></div>
                    
                    {formData.providerType === 'external' && (
                        <>
                            <div className="col-span-2">
                                <label className="block text-sm font-medium mb-1">Website URL</label>
                                <div className="flex gap-2">
                                    <input type="url" className="flex-1 px-3 py-2 border rounded-lg" placeholder="https://example.com" value={formData.websiteUrl} onChange={(e) => setFormData({...formData, websiteUrl: e.target.value})} />
                                    <button type="button" onClick={extractContactDetails} disabled={extracting} className="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 disabled:bg-gray-300 whitespace-nowrap">
                                        {extracting ? 'Extracting...' : ' Extract Contact'}
                                    </button>
                                </div>
                                {extractError && <p className="text-xs text-orange-600 mt-1">{extractError}</p>}
                            </div>
                            <div>
                                <label className="block text-sm font-medium mb-1">Contact Phone</label>
                                <input type="tel" className="w-full px-3 py-2 border rounded-lg" value={formData.contactPhone} onChange={(e) => setFormData({...formData, contactPhone: e.target.value})} />
                            </div>
                            <div>
                                <label className="block text-sm font-medium mb-1">Contact Email</label>
                                <input type="email" className="w-full px-3 py-2 border rounded-lg" value={formData.contactEmail} onChange={(e) => setFormData({...formData, contactEmail: e.target.value})} />
                            </div>
                        </>
                    )}
                    
                    <div><label className="block text-sm font-medium mb-1">Recertification (months)</label><input type="number" min="1" className="w-full px-3 py-2 border rounded-lg" value={formData.recertificationMonths} onChange={(e) => setFormData({...formData, recertificationMonths: e.target.value})} /></div>
                    <div><label className="block text-sm font-medium mb-1">Duration</label><input type="text" className="w-full px-3 py-2 border rounded-lg" value={formData.duration} onChange={(e) => setFormData({...formData, duration: e.target.value})} /></div>
                    <div><label className="block text-sm font-medium mb-1">Cost ($)</label><input type="number" min="0" step="0.01" className="w-full px-3 py-2 border rounded-lg" value={formData.cost} onChange={(e) => setFormData({...formData, cost: e.target.value})} /></div>
                    
                    <div className="col-span-2">
                        <label className="block text-sm font-medium mb-2">Linked Competencies</label>
                        <div className="bg-gray-50 p-3 rounded-lg max-h-40 overflow-y-auto">
                            {competencies && competencies.length > 0 ? (
                                <div className="grid grid-cols-1 gap-2">
                                    {competencies.map(comp => (
                                        <label key={comp.id} className="flex items-center gap-2 text-sm cursor-pointer hover:bg-white p-2 rounded">
                                            <input 
                                                type="checkbox"
                                                checked={(formData.linkedCompetencies || []).includes(comp.id)}
                                                onChange={() => handleCompetencyToggle(comp.id)}
                                                className="w-4 h-4"
                                            />
                                            <span className="flex-1">{comp.name}</span>
                                            {comp.category && <span className="text-xs text-gray-500">{comp.category}</span>}
                                        </label>
                                    ))}
                                </div>
                            ) : (
                                <p className="text-sm text-gray-500">No competencies available.</p>
                            )}
                        </div>
                    </div>
                    
                    <div className="col-span-2"><label className="block text-sm font-medium mb-1">Notes</label><textarea className="w-full px-3 py-2 border rounded-lg" rows="2" value={formData.notes} onChange={(e) => setFormData({...formData, notes: e.target.value})} /></div>
                </div>
                <div className="flex gap-3">
                    <button type="submit" className="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">{existingCourse ? 'Update' : 'Add'}</button>
                    <button type="button" onClick={onClose} className="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
                </div>
            </form>
        </Modal>
    );
}

function CompetencyEditorModal({ isOpen, onClose, onSave, existingCompetency, roles, onApplyToRoles, courses }) {
    const [formData, setFormData] = useState({
        name: '',
        category: '',
        description: '',
        howAchieved: '',
        validationType: [],
        assignmentType: 'specific',
        assignedRoles: [],
        assignedDepartments: [],
        requirementLevel: 'M(A)',
        linkedCourses: [],
        vocDocumentName: '',
        internalDocumentName: ''
    });

    useEffect(() => {
        if (existingCompetency) {
            setFormData({
                ...existingCompetency,
                validationType: existingCompetency.validationType || [],
                assignedRoles: existingCompetency.assignedRoles || [],
                assignedDepartments: existingCompetency.assignedDepartments || [],
                assignmentType: existingCompetency.assignmentType || 'specific',
                requirementLevel: existingCompetency.requirementLevel || 'M(A)',
                linkedCourses: existingCompetency.linkedCourses || [],
                vocDocumentName: existingCompetency.vocDocumentName || '',
                internalDocumentName: existingCompetency.internalDocumentName || ''
            });
        } else {
            setFormData({
                name: '',
                category: '',
                description: '',
                howAchieved: '',
                validationType: [],
                assignmentType: 'specific',
                assignedRoles: [],
                assignedDepartments: [],
                requirementLevel: 'M(A)',
                linkedCourses: [],
                vocDocumentName: '',
                internalDocumentName: ''
            });
        }
    }, [existingCompetency, isOpen]);

    const handleValidationTypeToggle = (type) => {
        const current = formData.validationType || [];
        if (current.includes(type)) {
            setFormData({...formData, validationType: current.filter(t => t !== type)});
        } else {
            setFormData({...formData, validationType: [...current, type]});
        }
    };

    const handleCourseToggle = (courseId) => {
        const current = formData.linkedCourses || [];
        if (current.includes(courseId)) {
            setFormData({...formData, linkedCourses: current.filter(c => c !== courseId)});
        } else {
            setFormData({...formData, linkedCourses: [...current, courseId]});
        }
    };

    const handleRoleToggle = (roleId) => {
        const current = formData.assignedRoles || [];
        if (current.includes(roleId)) {
            setFormData({...formData, assignedRoles: current.filter(r => r !== roleId)});
        } else {
            setFormData({...formData, assignedRoles: [...current, roleId]});
        }
    };

    const handleDepartmentToggle = (dept) => {
        const current = formData.assignedDepartments || [];
        if (current.includes(dept)) {
            setFormData({...formData, assignedDepartments: current.filter(d => d !== dept)});
        } else {
            setFormData({...formData, assignedDepartments: [...current, dept]});
        }
    };

    const departments = [...new Set(roles.map(r => r.department).filter(d => d))].sort();

    const handleSubmit = (e) => {
        e.preventDefault();
        const competency = {
            ...formData,
            id: existingCompetency?.id || 'comp_' + Date.now()
        };
        onSave(competency);
        
        // Apply to roles based on assignment type
        if (onApplyToRoles) {
            onApplyToRoles(competency);
        }
        
        onClose();
    };

    return (
        <Modal isOpen={isOpen} onClose={onClose} title={existingCompetency ? 'Edit Competency' : 'Add Competency'} size="xl">
            <form onSubmit={handleSubmit} className="space-y-4">
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label className="block text-sm font-medium mb-1">Competency Name *</label>
                        <input type="text" required className="w-full px-3 py-2 border rounded-lg" value={formData.name} onChange={(e) => setFormData({...formData, name: e.target.value})} />
                    </div>
                    <div>
                        <label className="block text-sm font-medium mb-1">Category</label>
                        <input type="text" className="w-full px-3 py-2 border rounded-lg" placeholder="e.g., Safety, Licence, Compliance" value={formData.category} onChange={(e) => setFormData({...formData, category: e.target.value})} />
                    </div>
                </div>

                <div>
                    <label className="block text-sm font-medium mb-1">Description</label>
                    <textarea className="w-full px-3 py-2 border rounded-lg" rows="3" placeholder="Brief description of the competency..." value={formData.description} onChange={(e) => setFormData({...formData, description: e.target.value})} />
                </div>

                <div>
                    <label className="block text-sm font-medium mb-1">How is it Achieved?</label>
                    <textarea className="w-full px-3 py-2 border rounded-lg" rows="2" placeholder="e.g., Complete training course, Pass assessment, On-the-job training..." value={formData.howAchieved} onChange={(e) => setFormData({...formData, howAchieved: e.target.value})} />
                </div>

                <div>
                    <label className="block text-sm font-medium mb-2">Validation Required (check all that apply)</label>
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                        {['Certificate', 'Licence', 'VOC (Verification of Competency)', 'Internal Assessment'].map(type => (
                            <label key={type} className="flex items-center gap-2 p-2 border rounded hover:bg-gray-50 cursor-pointer">
                                <input 
                                    type="checkbox" 
                                    checked={(formData.validationType || []).includes(type)}
                                    onChange={() => handleValidationTypeToggle(type)}
                                    className="w-4 h-4"
                                />
                                <span className="text-sm">{type}</span>
                            </label>
                        ))}
                    </div>
                </div>

                {(formData.validationType || []).includes('VOC (Verification of Competency)') && (
                    <div>
                        <label className="block text-sm font-medium mb-1">VOC Document Name</label>
                        <input 
                            type="text" 
                            className="w-full px-3 py-2 border rounded-lg" 
                            placeholder="e.g., VOC-Forklift-2024" 
                            value={formData.vocDocumentName} 
                            onChange={(e) => setFormData({...formData, vocDocumentName: e.target.value})} 
                        />
                    </div>
                )}

                {(formData.validationType || []).includes('Internal Assessment') && (
                    <div>
                        <label className="block text-sm font-medium mb-1">Internal Assessment Document Name</label>
                        <input 
                            type="text" 
                            className="w-full px-3 py-2 border rounded-lg" 
                            placeholder="e.g., IA-Manual-Handling-2024" 
                            value={formData.internalDocumentName} 
                            onChange={(e) => setFormData({...formData, internalDocumentName: e.target.value})} 
                        />
                    </div>
                )}

                <div>
                    <label className="block text-sm font-medium mb-2">Linked Training Courses</label>
                    <div className="bg-gray-50 p-3 rounded-lg max-h-48 overflow-y-auto">
                        {courses && courses.length > 0 ? (
                            <div className="grid grid-cols-1 gap-2">
                                {courses.map(course => (
                                    <label key={course.id} className="flex items-center gap-2 text-sm cursor-pointer hover:bg-white p-2 rounded">
                                        <input 
                                            type="checkbox"
                                            checked={(formData.linkedCourses || []).includes(course.id)}
                                            onChange={() => handleCourseToggle(course.id)}
                                            className="w-4 h-4"
                                        />
                                        <span className="flex-1">{course.name}</span>
                                        <span className={`px-2 py-1 rounded text-xs ${course.providerType === 'internal' ? 'badge-internal' : 'badge-external'}`}>
                                            {course.providerType === 'internal' ? 'Internal' : 'External'}
                                        </span>
                                    </label>
                                ))}
                            </div>
                        ) : (
                            <p className="text-sm text-gray-500">No courses available. Add courses first in the Training Courses tab.</p>
                        )}
                    </div>
                </div>

                <div className="border-t pt-4">
                    <label className="block text-sm font-medium mb-2">Assignment</label>
                    <div className="space-y-3">
                        <div className="flex gap-4">
                            <label className="flex items-center gap-2 cursor-pointer">
                                <input 
                                    type="radio" 
                                    name="assignmentType" 
                                    value="all"
                                    checked={formData.assignmentType === 'all'}
                                    onChange={(e) => setFormData({...formData, assignmentType: e.target.value})}
                                    className="w-4 h-4"
                                />
                                <span className="text-sm font-medium">All Council Staff</span>
                            </label>
                            <label className="flex items-center gap-2 cursor-pointer">
                                <input 
                                    type="radio" 
                                    name="assignmentType" 
                                    value="department"
                                    checked={formData.assignmentType === 'department'}
                                    onChange={(e) => setFormData({...formData, assignmentType: e.target.value})}
                                    className="w-4 h-4"
                                />
                                <span className="text-sm font-medium">By Department</span>
                            </label>
                            <label className="flex items-center gap-2 cursor-pointer">
                                <input 
                                    type="radio" 
                                    name="assignmentType" 
                                    value="specific"
                                    checked={formData.assignmentType === 'specific'}
                                    onChange={(e) => setFormData({...formData, assignmentType: e.target.value})}
                                    className="w-4 h-4"
                                />
                                <span className="text-sm font-medium">Specific Roles</span>
                            </label>
                        </div>

                        {formData.assignmentType === 'department' && (
                            <div className="bg-gray-50 p-3 rounded-lg">
                                <p className="text-sm font-medium mb-2">Select Departments:</p>
                                <div className="grid grid-cols-2 gap-2 max-h-40 overflow-y-auto">
                                    {departments.map(dept => (
                                        <label key={dept} className="flex items-center gap-2 text-sm cursor-pointer">
                                            <input 
                                                type="checkbox"
                                                checked={(formData.assignedDepartments || []).includes(dept)}
                                                onChange={() => handleDepartmentToggle(dept)}
                                                className="w-4 h-4"
                                            />
                                            <span>{dept}</span>
                                        </label>
                                    ))}
                                </div>
                            </div>
                        )}

                        {formData.assignmentType === 'specific' && (
                            <div className="bg-gray-50 p-3 rounded-lg">
                                <p className="text-sm font-medium mb-2">Select Roles:</p>
                                <div className="grid grid-cols-1 gap-2 max-h-60 overflow-y-auto">
                                    {roles.filter(r => r.id !== 'role_0').map(role => (
                                        <label key={role.id} className="flex items-center gap-2 text-sm cursor-pointer hover:bg-white p-1 rounded">
                                            <input 
                                                type="checkbox"
                                                checked={(formData.assignedRoles || []).includes(role.id)}
                                                onChange={() => handleRoleToggle(role.id)}
                                                className="w-4 h-4"
                                            />
                                            <span>{role.name} {role.department && <span className="text-gray-500">({role.department})</span>}</span>
                                        </label>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>
                </div>

                <div>
                    <label className="block text-sm font-medium mb-1">Requirement Level</label>
                    <select className="w-full px-3 py-2 border rounded-lg" value={formData.requirementLevel} onChange={(e) => setFormData({...formData, requirementLevel: e.target.value})}>
                        <option value="M(A)">M(A) - Mandatory (All)</option>
                        <option value="M(S)">M(S) - Mandatory (Specific)</option>
                        <option value="D(A)">D(A) - Desirable (All)</option>
                        <option value="D(S)">D(S) - Desirable (Specific)</option>
                        <option value="LM">LM - License Mandatory</option>
                    </select>
                </div>

                <div className="flex gap-3 pt-4">
                    <button type="submit" className="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
                        {existingCompetency ? 'Update' : 'Create'} Competency
                    </button>
                    <button type="button" onClick={onClose} className="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
                </div>
            </form>
        </Modal>
    );
}

function TrainingRecordModal({ isOpen, onClose, onSave, person, competency, existingRecord, courses }) {
    const [formData, setFormData] = useState({ courseId: '', completedDate: '', expiryDate: '', certificateNumber: '', notes: '', recordFileUrl: '', recordFileName: '', cm10Link: '' });
    const [uploading, setUploading] = useState(false);
    const [uploadError, setUploadError] = useState('');
    
    useEffect(() => {
        if (existingRecord) { 
            setFormData(existingRecord); 
        }
        else { 
            setFormData({ courseId: '', completedDate: '', expiryDate: '', certificateNumber: '', notes: '', recordFileUrl: '', recordFileName: '', cm10Link: '' }); 
        }
        setUploadError('');
    }, [existingRecord, isOpen]);
    
    const handleFileUpload = async (e) => {
        const file = e.target.files[0];
        if (!file) return;
        
        // Validate file size (5MB)
        if (file.size > 5 * 1024 * 1024) {
            setUploadError('File too large. Maximum 5MB allowed.');
            return;
        }
        
        setUploading(true);
        setUploadError('');
        
        try {
            const formDataObj = new FormData();
            formDataObj.append('file', file);
            formDataObj.append('personId', person.id);
            formDataObj.append('competencyId', competency.id);
            
            const response = await fetch('/api/upload.php', {
                method: 'POST',
                body: formDataObj
            });
            
            const result = await response.json();
            
            if (result.success) {
                setFormData({
                    ...formData,
                    recordFileUrl: result.url,
                    recordFileName: result.originalName
                });
                setUploadError('');
            } else {
                setUploadError(result.error || 'Upload failed');
            }
        } catch (error) {
            setUploadError('Upload failed: ' + error.message);
        } finally {
            setUploading(false);
        }
    };
    
    const handleRemoveFile = async () => {
        if (formData.recordFileUrl) {
            try {
                // Extract filename from URL
                const filename = formData.recordFileUrl.split('/').pop();
                
                await fetch('/api/upload.php', {
                    method: 'DELETE',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ filename })
                });
            } catch (error) {
                console.error('Error deleting file:', error);
            }
        }
        
        setFormData({
            ...formData,
            recordFileUrl: '',
            recordFileName: ''
        });
    };
    
    const handleDownloadFile = () => {
        if (formData.recordFileUrl) {
            window.open(formData.recordFileUrl, '_blank');
        }
    };
    
    const handleSubmit = (e) => { 
        e.preventDefault(); 
        onSave({ 
            personId: person.id, 
            competencyId: competency.id, 
            ...formData, 
            recordId: existingRecord?.recordId || 'r' + Date.now() 
        }); 
        onClose(); 
    };
    
    if (!isOpen) return null;
    
    return (
        <Modal isOpen={isOpen} onClose={onClose} title="Training Record" size="lg">
            <div className="mb-4">
                <p className="text-sm"><strong>Person:</strong> {person?.name}</p>
                <p className="text-sm"><strong>Training:</strong> {competency?.name}</p>
            </div>
            <form onSubmit={handleSubmit} className="space-y-4">
                <div>
                    <label className="block text-sm font-medium mb-1">Select Course *</label>
                    <select required className="w-full px-3 py-2 border rounded-lg" value={formData.courseId} onChange={(e) => setFormData({...formData, courseId: e.target.value})}>
                        <option value="">Choose...</option>
                        {courses.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}
                    </select>
                </div>
                
                <div className="grid grid-cols-2 gap-4">
                    <div>
                        <label className="block text-sm font-medium mb-1">Completed Date *</label>
                        <input type="date" required className="w-full px-3 py-2 border rounded-lg" value={formData.completedDate} onChange={(e) => setFormData({...formData, completedDate: e.target.value})} />
                    </div>
                    <div>
                        <label className="block text-sm font-medium mb-1">Expiry Date</label>
                        <input type="date" className="w-full px-3 py-2 border rounded-lg" value={formData.expiryDate} onChange={(e) => setFormData({...formData, expiryDate: e.target.value})} />
                    </div>
                </div>
                
                <div>
                    <label className="block text-sm font-medium mb-1">Certificate Number</label>
                    <input type="text" className="w-full px-3 py-2 border rounded-lg" value={formData.certificateNumber} onChange={(e) => setFormData({...formData, certificateNumber: e.target.value})} />
                </div>
                
                <div>
                    <label className="block text-sm font-medium mb-1">Upload Certificate / Record</label>
                    <div className="border-2 border-dashed border-gray-300 rounded-lg p-4">
                        {!formData.recordFileUrl ? (
                            <div>
                                <input 
                                    type="file" 
                                    accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" 
                                    onChange={handleFileUpload}
                                    disabled={uploading}
                                    className="w-full text-sm"
                                />
                                {uploading && <p className="text-xs text-blue-600 mt-2">Uploading...</p>}
                                {uploadError && <p className="text-xs text-red-600 mt-2">{uploadError}</p>}
                                <p className="text-xs text-gray-500 mt-2">
                                    Accepted: PDF, JPG, PNG, DOC, DOCX (Max 5MB) - Stored on server
                                </p>
                            </div>
                        ) : (
                            <div className="flex items-center justify-between bg-green-50 border border-green-200 rounded p-3">
                                <div className="flex items-center gap-2">
                                    <span className="text-green-600"></span>
                                    <span className="text-sm font-medium">{formData.recordFileName}</span>
                                </div>
                                <div className="flex gap-2">
                                    <button 
                                        type="button" 
                                        onClick={handleDownloadFile}
                                        className="text-xs bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600"
                                    >
                                        Download
                                    </button>
                                    <button 
                                        type="button" 
                                        onClick={handleRemoveFile}
                                        className="text-xs bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600"
                                    >
                                        Remove
                                    </button>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
                
                <div>
                    <label className="block text-sm font-medium mb-1">CM10 Record Link (URL)</label>
                    <div className="flex gap-2">
                        <input 
                            type="url" 
                            className="flex-1 px-3 py-2 border rounded-lg" 
                            placeholder="https://cm10.cookshire.qld.gov.au/..." 
                            value={formData.cm10Link} 
                            onChange={(e) => setFormData({...formData, cm10Link: e.target.value})} 
                        />
                        {formData.cm10Link && (
                            <a 
                                href={formData.cm10Link} 
                                target="_blank" 
                                rel="noopener noreferrer"
                                className="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 text-sm whitespace-nowrap"
                            >
                                Open CM10
                            </a>
                        )}
                    </div>
                    <p className="text-xs text-gray-500 mt-1">Link to CM10 document management system record</p>
                </div>
                
                <div>
                    <label className="block text-sm font-medium mb-1">Notes</label>
                    <textarea className="w-full px-3 py-2 border rounded-lg" rows="3" value={formData.notes} onChange={(e) => setFormData({...formData, notes: e.target.value})} />
                </div>
                
                <div className="flex gap-3">
                    <button type="submit" className="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg">Save Record</button>
                    <button type="button" onClick={onClose} className="flex-1 bg-gray-300 px-4 py-2 rounded-lg">Cancel</button>
                </div>
            </form>
        </Modal>
    );
}

function PeopleModal({ isOpen, onClose, onSave, existingPerson, roles }) {
    const [formData, setFormData] = useState({ name: '', roleId: '', department: '', email: '', usi: '', dob: '', phone: '' });
    useEffect(() => {
        if (existingPerson) { setFormData(existingPerson); }
        else { setFormData({ name: '', roleId: '', department: '', email: '', usi: '', dob: '', phone: '' }); }
    }, [existingPerson, isOpen]);
    const handleSubmit = (e) => {
        e.preventDefault();
        const selectedRole = roles.find(r => r.id === formData.roleId);
        onSave({ 
            ...formData, 
            id: existingPerson?.id || 'p' + Date.now(),
            department: selectedRole?.department || formData.department 
        });
        onClose();
    };
    return (
        <Modal isOpen={isOpen} onClose={onClose} title={existingPerson ? 'Edit Person' : 'Add Person'} size="lg">
            <form onSubmit={handleSubmit} className="space-y-4">
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label className="block text-sm font-medium mb-1">Name *</label>
                        <input type="text" required className="w-full px-3 py-2 border rounded-lg" value={formData.name} onChange={(e) => setFormData({...formData, name: e.target.value})} />
                    </div>
                    <div>
                        <label className="block text-sm font-medium mb-1">Role *</label>
                        <select required className="w-full px-3 py-2 border rounded-lg" value={formData.roleId} onChange={(e) => setFormData({...formData, roleId: e.target.value})}>
                            <option value="">Select a role...</option>
                            {roles.filter(r => r.id !== 'role_0').map(role => (
                                <option key={role.id} value={role.id}>{role.name} {role.department ? `(${role.department})` : ''}</option>
                            ))}
                        </select>
                    </div>
                    <div>
                        <label className="block text-sm font-medium mb-1">Email</label>
                        <input type="email" className="w-full px-3 py-2 border rounded-lg" value={formData.email} onChange={(e) => setFormData({...formData, email: e.target.value})} />
                    </div>
                    <div>
                        <label className="block text-sm font-medium mb-1">Mobile Phone</label>
                        <input type="tel" className="w-full px-3 py-2 border rounded-lg" placeholder="04XX XXX XXX" value={formData.phone} onChange={(e) => setFormData({...formData, phone: e.target.value})} />
                    </div>
                    <div>
                        <label className="block text-sm font-medium mb-1">USI (Unique Student Identifier)</label>
                        <input type="text" className="w-full px-3 py-2 border rounded-lg" placeholder="10 character code" maxLength="10" value={formData.usi} onChange={(e) => setFormData({...formData, usi: e.target.value.toUpperCase()})} />
                    </div>
                    <div>
                        <label className="block text-sm font-medium mb-1">Date of Birth</label>
                        <input type="date" className="w-full px-3 py-2 border rounded-lg" value={formData.dob} onChange={(e) => setFormData({...formData, dob: e.target.value})} />
                    </div>
                </div>
                <div className="flex gap-3">
                    <button type="submit" className="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">{existingPerson ? 'Update' : 'Add'} Person</button>
                    <button type="button" onClick={onClose} className="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
                </div>
            </form>
        </Modal>
    );
}

function CSVUploadModal({ isOpen, onClose, onUpload, roles }) {
    const [csvText, setCsvText] = useState('');
    const [preview, setPreview] = useState([]);
    const [error, setError] = useState('');

    const parseCSV = (text) => {
        try {
            const lines = text.trim().split('\n');
            if (lines.length < 2) {
                setError('CSV must have header row and at least one data row');
                return;
            }
            
            const headers = lines[0].split(',').map(h => h.trim().toLowerCase());
            const nameIdx = headers.findIndex(h => h.includes('name'));
            const roleIdx = headers.findIndex(h => h.includes('role'));
            const emailIdx = headers.findIndex(h => h.includes('email'));
            const phoneIdx = headers.findIndex(h => h.includes('phone') || h.includes('mobile'));
            const usiIdx = headers.findIndex(h => h.includes('usi'));
            const dobIdx = headers.findIndex(h => h.includes('dob') || h.includes('birth'));
            
            if (nameIdx === -1 || roleIdx === -1) {
                setError('CSV must have "Name" and "Role" columns');
                return;
            }

            const people = [];
            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',').map(v => v.trim());
                const name = values[nameIdx];
                const roleName = values[roleIdx];
                const email = emailIdx >= 0 ? values[emailIdx] : '';
                const phone = phoneIdx >= 0 ? values[phoneIdx] : '';
                const usi = usiIdx >= 0 ? values[usiIdx].toUpperCase() : '';
                const dob = dobIdx >= 0 ? values[dobIdx] : '';
                
                if (!name || !roleName) continue;
                
                // Find matching role
                const role = roles.find(r => r.name.toLowerCase() === roleName.toLowerCase());
                if (!role) {
                    setError(`Role not found: ${roleName}. Please check spelling or add role first.`);
                    return;
                }
                
                people.push({
                    id: 'p' + Date.now() + i,
                    name,
                    roleId: role.id,
                    department: role.department,
                    email,
                    phone,
                    usi,
                    dob
                });
            }
            
            setPreview(people);
            setError('');
        } catch (e) {
            setError('Error parsing CSV: ' + e.message);
        }
    };

    const handleFileUpload = (e) => {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (event) => {
                const text = event.target.result;
                setCsvText(text);
                parseCSV(text);
            };
            reader.readAsText(file);
        }
    };

    const handleUpload = () => {
        if (preview.length > 0) {
            onUpload(preview);
            setCsvText('');
            setPreview([]);
            onClose();
        }
    };

    return (
        <Modal isOpen={isOpen} onClose={onClose} title="Upload People from CSV" size="lg">
            <div className="space-y-4">
                <div className="bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm">
                    <p className="font-semibold mb-2">CSV Format:</p>
                    <p className="mb-1">Headers: <code className="bg-white px-1">Name, Role, Email, Phone, USI, DOB</code></p>
                    <p className="text-xs text-gray-600 mb-1">Required: Name, Role | Optional: Email, Phone, USI, DOB</p>
                    <p className="text-xs text-gray-600">Example:</p>
                    <pre className="bg-white p-2 rounded mt-1 text-xs">Name, Role, Email, Phone, USI, DOB
John Smith, Depot Administration Officer, john@example.com, 0412345678, ABC1234567, 1985-03-15
Sarah Johnson, Diesel Fitter, sarah@example.com, 0423456789, XYZ9876543, 1990-07-22</pre>
                </div>
                
                <div>
                    <label className="block text-sm font-medium mb-1">Upload CSV File</label>
                    <input type="file" accept=".csv" onChange={handleFileUpload} className="w-full px-3 py-2 border rounded-lg" />
                </div>

                {error && (
                    <div className="bg-red-50 border border-red-200 text-red-700 rounded-lg p-3 text-sm">
                        {error}
                    </div>
                )}

                {preview.length > 0 && (
                    <div>
                        <p className="font-semibold mb-2">Preview ({preview.length} people):</p>
                        <div className="border rounded-lg max-h-60 overflow-y-auto">
                            <table className="w-full text-sm">
                                <thead className="bg-gray-100 sticky top-0">
                                    <tr>
                                        <th className="p-2 text-left">Name</th>
                                        <th className="p-2 text-left">Role</th>
                                        <th className="p-2 text-left">Department</th>
                                        <th className="p-2 text-left">Email</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {preview.map((person, idx) => (
                                        <tr key={idx} className="border-t">
                                            <td className="p-2">{person.name}</td>
                                            <td className="p-2">{roles.find(r => r.id === person.roleId)?.name}</td>
                                            <td className="p-2 text-gray-600">{person.department}</td>
                                            <td className="p-2 text-gray-600">{person.email}</td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                )}

                <div className="flex gap-3">
                    <button 
                        type="button" 
                        onClick={handleUpload} 
                        disabled={preview.length === 0}
                        className="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed"
                    >
                        Upload {preview.length} {preview.length === 1 ? 'Person' : 'People'}
                    </button>
                    <button type="button" onClick={onClose} className="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
                </div>
            </div>
        </Modal>
    );
}

function TrainingManagementSystem() {
    const [roles, setRoles] = useState([]);
    const [competencies, setCompetencies] = useState([]);
    const [requirements, setRequirements] = useState({});
    const [people, setPeople] = useState([]);
    const [courses, setCourses] = useState([]);
    const [trainingRecords, setTrainingRecords] = useState([]);
    const [activeTab, setActiveTab] = useState('matrix');
    const [selectedPerson, setSelectedPerson] = useState(null);
    
    const [filterDepartment, setFilterDepartment] = useState('');
    const [filterCategory, setFilterCategory] = useState('');
    const [filterRequirement, setFilterRequirement] = useState('');
    const [searchTerm, setSearchTerm] = useState('');
    
    const [filterPeopleDepartment, setFilterPeopleDepartment] = useState('');
    const [filterPeopleRole, setFilterPeopleRole] = useState('');
    const [searchPeople, setSearchPeople] = useState('');
    
    const [requirementModalOpen, setRequirementModalOpen] = useState(false);
    const [editingRequirement, setEditingRequirement] = useState(null);
    const [courseModalOpen, setCourseModalOpen] = useState(false);
    const [editingCourse, setEditingCourse] = useState(null);
    const [trainingRecordModalOpen, setTrainingRecordModalOpen] = useState(false);
    const [editingRecord, setEditingRecord] = useState(null);
    const [peopleModalOpen, setPeopleModalOpen] = useState(false);
    const [editingPerson, setEditingPerson] = useState(null);
    const [csvUploadModalOpen, setCsvUploadModalOpen] = useState(false);
    const [competencyEditorModalOpen, setCompetencyEditorModalOpen] = useState(false);
    const [editingCompetency, setEditingCompetency] = useState(null);

    useEffect(() => {
        const savedRequirements = localStorage.getItem('trainingRequirements');
        const savedPeople = localStorage.getItem('trainingPeople');
        const savedCourses = localStorage.getItem('trainingCourses');
        const savedRecords = localStorage.getItem('trainingRecords');
        
        setRoles(FULL_MATRIX_DATA.roles);
        setCompetencies(FULL_MATRIX_DATA.competencies);
        setRequirements(savedRequirements ? JSON.parse(savedRequirements) : FULL_MATRIX_DATA.requirements);
        setPeople(savedPeople ? JSON.parse(savedPeople) : INITIAL_PEOPLE);
        setCourses(savedCourses ? JSON.parse(savedCourses) : INITIAL_COURSES);
        setTrainingRecords(savedRecords ? JSON.parse(savedRecords) : []);
    }, []);

    const saveRequirements = (newReqs) => { setRequirements(newReqs); localStorage.setItem('trainingRequirements', JSON.stringify(newReqs)); };
    const saveCourses = (newCourses) => { setCourses(newCourses); localStorage.setItem('trainingCourses', JSON.stringify(newCourses)); };
    const saveRecords = (newRecords) => { setTrainingRecords(newRecords); localStorage.setItem('trainingRecords', JSON.stringify(newRecords)); };
    const savePeople = (newPeople) => { setPeople(newPeople); localStorage.setItem('trainingPeople', JSON.stringify(newPeople)); };

    const departments = useMemo(() => [...new Set(roles.map(r => r.department).filter(d => d))].sort(), [roles]);
    const categories = useMemo(() => [...new Set(competencies.map(c => c.category).filter(c => c))].sort(), [competencies]);
    const peopleDepartments = useMemo(() => [...new Set(people.map(p => p.department).filter(d => d))].sort(), [people]);

    const filteredRoles = useMemo(() => {
        let filtered = roles;
        if (filterDepartment) filtered = filtered.filter(r => r.department === filterDepartment);
        if (searchTerm) filtered = filtered.filter(r => r.name.toLowerCase().includes(searchTerm.toLowerCase()));
        return filtered;
    }, [roles, filterDepartment, searchTerm]);

    const filteredCompetencies = useMemo(() => {
        let filtered = competencies;
        if (filterCategory) filtered = filtered.filter(c => c.category === filterCategory);
        if (filterRequirement) {
            filtered = filtered.filter(c => {
                const reqs = requirements[c.id] || {};
                return Object.values(reqs).some(r => r === filterRequirement);
            });
        }
        if (searchTerm) filtered = filtered.filter(c => c.name.toLowerCase().includes(searchTerm.toLowerCase()));
        return filtered;
    }, [competencies, filterCategory, filterRequirement, requirements, searchTerm]);

    const filteredPeople = useMemo(() => {
        let filtered = people;
        if (filterPeopleDepartment) filtered = filtered.filter(p => p.department === filterPeopleDepartment);
        if (filterPeopleRole) filtered = filtered.filter(p => p.roleId === filterPeopleRole);
        if (searchPeople) filtered = filtered.filter(p => p.name.toLowerCase().includes(searchPeople.toLowerCase()));
        return filtered;
    }, [people, filterPeopleDepartment, filterPeopleRole, searchPeople]);

    const handleSaveRequirement = (compId, roleId, requirement) => {
        const newReqs = {...requirements};
        if (!newReqs[compId]) newReqs[compId] = {};
        if (requirement) { newReqs[compId][roleId] = requirement; }
        else { delete newReqs[compId][roleId]; }
        saveRequirements(newReqs);
    };

    const handleSaveCourse = (course) => {
        const existing = courses.findIndex(c => c.id === course.id);
        if (existing >= 0) { const updated = [...courses]; updated[existing] = course; saveCourses(updated); }
        else { saveCourses([...courses, course]); }
        setEditingCourse(null);
    };

    const handleDeleteCourse = (courseId) => { if (confirm('Delete?')) saveCourses(courses.filter(c => c.id !== courseId)); };

    const handleSaveTrainingRecord = (record) => {
        const existing = trainingRecords.findIndex(r => r.personId === record.personId && r.competencyId === record.competencyId);
        if (existing >= 0) { const updated = [...trainingRecords]; updated[existing] = record; saveRecords(updated); }
        else { saveRecords([...trainingRecords, record]); }
        setEditingRecord(null);
    };

    const handleSavePerson = (person) => {
        const existing = people.findIndex(p => p.id === person.id);
        if (existing >= 0) { const updated = [...people]; updated[existing] = person; savePeople(updated); }
        else { savePeople([...people, person]); }
        setEditingPerson(null);
    };

    const handleDeletePerson = (personId) => {
        if (confirm('Delete this person? Their training records will also be deleted.')) {
            savePeople(people.filter(p => p.id !== personId));
            saveRecords(trainingRecords.filter(r => r.personId !== personId));
        }
    };

    const handleCSVUpload = (newPeople) => {
        savePeople([...people, ...newPeople]);
    };

    const handleSaveCompetency = (competency) => {
        const existing = competencies.findIndex(c => c.id === competency.id);
        let updated;
        if (existing >= 0) {
            updated = [...competencies];
            updated[existing] = competency;
        } else {
            updated = [...competencies, competency];
        }
        setCompetencies(updated);
        localStorage.setItem('trainingCompetencies', JSON.stringify(updated));
        setEditingCompetency(null);
    };

    const handleApplyCompetencyToRoles = (competency) => {
        const newRequirements = {...requirements};
        
        // Initialize competency requirements if not exists
        if (!newRequirements[competency.id]) {
            newRequirements[competency.id] = {};
        }
        
        if (competency.assignmentType === 'all') {
            // Apply to all roles
            roles.filter(r => r.id !== 'role_0').forEach(role => {
                newRequirements[competency.id][role.id] = competency.requirementLevel;
            });
        } else if (competency.assignmentType === 'department') {
            // Apply to selected departments
            roles.filter(r => 
                r.id !== 'role_0' && 
                (competency.assignedDepartments || []).includes(r.department)
            ).forEach(role => {
                newRequirements[competency.id][role.id] = competency.requirementLevel;
            });
        } else if (competency.assignmentType === 'specific') {
            // Apply to selected roles
            (competency.assignedRoles || []).forEach(roleId => {
                newRequirements[competency.id][roleId] = competency.requirementLevel;
            });
        }
        
        saveRequirements(newRequirements);
    };

    const getTrainingStatus = (record) => {
        if (!record) return 'pending';
        if (!record.expiryDate) return 'complete';
        const days = Math.floor((new Date(record.expiryDate) - new Date()) / 86400000);
        if (days < 0) return 'expired';
        if (days <= 30) return 'expiring';
        return 'complete';
    };

    const getStatusBadge = (status) => {
        const classes = { complete: 'status-complete', expiring: 'status-expiring', expired: 'status-expired', pending: 'status-pending' };
        const labels = { complete: 'Current', expiring: 'Expiring Soon', expired: 'Expired', pending: 'Not Completed' };
        return <span className={`px-2 py-1 rounded text-xs font-semibold ${classes[status]}`}>{labels[status]}</span>;
    };

    return (
        <div className="min-h-screen bg-gray-50">
            <div className="bg-blue-600 text-white p-6 shadow-lg">
                <h1 className="text-3xl font-bold">Training Management System</h1>
                <p className="mt-2 text-blue-100">Cook Shire Council - {roles.length} Roles, {competencies.length} Competencies</p>
            </div>

            <div className="bg-white shadow">
                <div className="flex border-b">
                    <button onClick={() => setActiveTab('matrix')} className={`px-6 py-3 font-semibold ${activeTab === 'matrix' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-gray-600'}`}>Competency Matrix</button>
                    <button onClick={() => setActiveTab('courses')} className={`px-6 py-3 font-semibold ${activeTab === 'courses' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-gray-600'}`}>Training Courses</button>
                    <button onClick={() => setActiveTab('people')} className={`px-6 py-3 font-semibold ${activeTab === 'people' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-gray-600'}`}>People & Records</button>
                    <button onClick={() => setActiveTab('reports')} className={`px-6 py-3 font-semibold ${activeTab === 'reports' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-gray-600'}`}>Reports</button>
                </div>
            </div>

            <div className="p-6">
                {activeTab === 'matrix' && (
                    <div className="bg-white rounded-lg shadow-lg p-6">
                        <div className="flex justify-between items-center mb-4">
                            <h2 className="text-xl font-bold">Competency Requirements Matrix</h2>
                            <button 
                                onClick={() => { setEditingCompetency(null); setCompetencyEditorModalOpen(true); }} 
                                className="bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600 text-sm"
                            >
                                + Add Competency
                            </button>
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-3 mb-4">
                            <div><label className="block text-xs font-medium mb-1">Department</label><select className="w-full px-2 py-1 border rounded text-sm" value={filterDepartment} onChange={(e) => setFilterDepartment(e.target.value)}><option value="">All Departments</option>{departments.map(d => <option key={d} value={d}>{d}</option>)}</select></div>
                            <div><label className="block text-xs font-medium mb-1">Category</label><select className="w-full px-2 py-1 border rounded text-sm" value={filterCategory} onChange={(e) => setFilterCategory(e.target.value)}><option value="">All Categories</option>{categories.map(c => <option key={c} value={c}>{c}</option>)}</select></div>
                            <div><label className="block text-xs font-medium mb-1">Requirement</label><select className="w-full px-2 py-1 border rounded text-sm" value={filterRequirement} onChange={(e) => setFilterRequirement(e.target.value)}><option value="">All</option><option value="M(A)">M(A)</option><option value="M(S)">M(S)</option><option value="D(A)">D(A)</option><option value="D(S)">D(S)</option><option value="LM">LM</option></select></div>
                            <div><label className="block text-xs font-medium mb-1">Search</label><input type="text" className="w-full px-2 py-1 border rounded text-sm" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} placeholder="Role or competency..." /></div>
                        </div>
                        <div className="flex gap-2 mb-3 text-xs flex-wrap">
                            <div className="flex items-center gap-1"><span className="px-2 py-1 rounded bg-red-500 text-white font-semibold">M(A)</span> Mandatory (All)</div>
                            <div className="flex items-center gap-1"><span className="px-2 py-1 rounded bg-red-500 text-white font-semibold">M(S)</span> Mandatory (Specific)</div>
                            <div className="flex items-center gap-1"><span className="px-2 py-1 rounded bg-blue-500 text-white font-semibold">D(A)</span> Desirable (All)</div>
                            <div className="flex items-center gap-1"><span className="px-2 py-1 rounded bg-blue-500 text-white font-semibold">D(S)</span> Desirable (Specific)</div>
                            <div className="flex items-center gap-1"><span className="px-2 py-1 rounded bg-orange-500 text-white font-semibold">LM</span> License Mandatory</div>
                        </div>
                        <p className="text-xs text-gray-600 mb-3">Showing {filteredCompetencies.length} competencies across {filteredRoles.length} roles. Click any cell to edit.</p>
                        <div className="overflow-x-auto" style={{maxHeight: '600px'}}>
                            <table className="w-full border-collapse border text-xs">
                                <thead className="sticky top-0 bg-gray-100">
                                    <tr>
                                        <th className="border p-2 text-left bg-gray-100" style={{minWidth: '200px', position: 'sticky', left: 0, zIndex: 2}}>Competency</th>
                                        <th className="border p-2 text-left bg-gray-100" style={{minWidth: '100px', position: 'sticky', left: '200px', zIndex: 2}}>Category</th>
                                        {filteredRoles.slice(0, 20).map(role => <th key={role.id} className="border p-1 bg-gray-100" style={{minWidth: '80px'}}><div className="font-semibold">{role.name}</div><div className="text-gray-500 font-normal">{role.department}</div></th>)}
                                    </tr>
                                </thead>
                                <tbody>
                                    {filteredCompetencies.map((comp, idx) => (
                                        <tr key={comp.id} className={idx % 2 === 0 ? 'bg-white' : 'bg-gray-50'}>
                                            <td className="border p-2" style={{position: 'sticky', left: 0, background: 'inherit', zIndex: 1}}>
                                                <div className="flex items-center justify-between gap-2">
                                                    <span className="font-medium">{comp.name}</span>
                                                    <button 
                                                        onClick={() => { setEditingCompetency(comp); setCompetencyEditorModalOpen(true); }} 
                                                        className="text-blue-500 hover:text-blue-700 text-xs px-2 py-1 hover:bg-blue-50 rounded"
                                                        title="Edit competency"
                                                    >
                                                        
                                                    </button>
                                                </div>
                                            </td>
                                            <td className="border p-2 text-gray-600" style={{position: 'sticky', left: '200px', background: 'inherit', zIndex: 1}}>{comp.category}</td>
                                            {filteredRoles.slice(0, 20).map(role => {
                                                const req = requirements[comp.id]?.[role.id];
                                                return (
                                                    <td key={role.id} className="border p-1 text-center">
                                                        <button onClick={() => { setEditingRequirement({ competency: comp, role, currentRequirement: req }); setRequirementModalOpen(true); }} className="w-full hover:bg-gray-200 p-1 rounded">
                                                            {req ? <span className={`px-2 py-1 rounded font-semibold ${req.startsWith('M') ? 'bg-red-500 text-white' : req === 'LM' ? 'bg-orange-500 text-white' : 'bg-blue-500 text-white'}`}>{req}</span> : <span className="text-gray-300"></span>}
                                                        </button>
                                                    </td>
                                                );
                                            })}
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                        {filteredRoles.length > 20 && <p className="text-xs text-gray-500 mt-2">Showing first 20 of {filteredRoles.length} roles. Use filters to narrow down.</p>}
                    </div>
                )}

                {activeTab === 'courses' && (
                    <div className="bg-white rounded-lg shadow-lg p-6">
                        <div className="flex justify-between mb-6">
                            <h2 className="text-xl font-bold">Training Courses</h2>
                            <button onClick={() => { setEditingCourse(null); setCourseModalOpen(true); }} className="bg-blue-500 text-white px-4 py-2 rounded-lg">+ Add Course</button>
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                            {courses.map(course => (
                                <div key={course.id} className="border rounded-lg p-4">
                                    <div className="flex justify-between mb-2">
                                        <h3 className="font-bold text-sm">{course.name}</h3>
                                        <button onClick={() => handleDeleteCourse(course.id)} className="text-red-500"></button>
                                    </div>
                                    <div className="text-xs space-y-1 mb-3">
                                        <span className={`inline-block px-2 py-1 rounded ${course.providerType === 'internal' ? 'badge-internal' : 'badge-external'}`}>{course.providerType === 'internal' ? 'Internal' : 'External'}</span>
                                        <p><strong>Provider:</strong> {course.provider}</p>
                                        {course.duration && <p><strong>Duration:</strong> {course.duration}</p>}
                                        {course.recertificationMonths && <p><strong>Recertification:</strong> {course.recertificationMonths} months</p>}
                                        {course.cost > 0 && <p><strong>Cost:</strong> ${course.cost}</p>}
                                        {course.websiteUrl && <p><strong> Website:</strong> <a href={course.websiteUrl} target="_blank" rel="noopener noreferrer" className="text-blue-500 hover:underline">Visit</a></p>}
                                        {course.contactPhone && <p><strong> Phone:</strong> {course.contactPhone}</p>}
                                        {course.contactEmail && <p><strong> Email:</strong> {course.contactEmail}</p>}
                                    </div>
                                    <button onClick={() => { setEditingCourse(course); setCourseModalOpen(true); }} className="w-full bg-gray-100 px-3 py-1 rounded text-xs">Edit</button>
                                </div>
                            ))}
                        </div>
                    </div>
                )}

                {activeTab === 'people' && (
                    <div>
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <div className="flex justify-between items-center mb-4">
                                <h2 className="text-xl font-bold">Staff Members ({filteredPeople.length} of {people.length})</h2>
                                <div className="flex gap-2">
                                    <button onClick={() => { setEditingPerson(null); setPeopleModalOpen(true); }} className="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">+ Add Person</button>
                                    <button onClick={() => setCsvUploadModalOpen(true)} className="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600"> Upload CSV</button>
                                </div>
                            </div>
                            
                            {/* Filter Controls */}
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-3 mb-4">
                                <div>
                                    <label className="block text-xs font-medium mb-1">Search Name</label>
                                    <input 
                                        type="text" 
                                        className="w-full px-2 py-1 border rounded text-sm" 
                                        placeholder="Search by name..." 
                                        value={searchPeople} 
                                        onChange={(e) => setSearchPeople(e.target.value)} 
                                    />
                                </div>
                                <div>
                                    <label className="block text-xs font-medium mb-1">Department</label>
                                    <select 
                                        className="w-full px-2 py-1 border rounded text-sm" 
                                        value={filterPeopleDepartment} 
                                        onChange={(e) => setFilterPeopleDepartment(e.target.value)}
                                    >
                                        <option value="">All Departments</option>
                                        {peopleDepartments.map(dept => (
                                            <option key={dept} value={dept}>{dept}</option>
                                        ))}
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-xs font-medium mb-1">Role</label>
                                    <select 
                                        className="w-full px-2 py-1 border rounded text-sm" 
                                        value={filterPeopleRole} 
                                        onChange={(e) => setFilterPeopleRole(e.target.value)}
                                    >
                                        <option value="">All Roles</option>
                                        {roles.filter(r => r.id !== 'role_0').map(role => (
                                            <option key={role.id} value={role.id}>{role.name}</option>
                                        ))}
                                    </select>
                                </div>
                                <div className="flex items-end">
                                    <button 
                                        onClick={() => { setSearchPeople(''); setFilterPeopleDepartment(''); setFilterPeopleRole(''); }} 
                                        className="w-full bg-gray-200 px-3 py-1 rounded text-sm hover:bg-gray-300"
                                    >
                                        Clear Filters
                                    </button>
                                </div>
                            </div>
                            
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                {filteredPeople.map(person => (
                                    <div key={person.id} className="border rounded-lg p-4">
                                        <div className="flex justify-between items-start mb-2">
                                            <div className="flex-1">
                                                <h3 className="font-bold">{person.name}</h3>
                                                <p className="text-sm text-gray-600">{roles.find(r => r.id === person.roleId)?.name}</p>
                                                {person.department && <p className="text-xs text-gray-500">{person.department}</p>}
                                                <div className="mt-2 text-xs space-y-1">
                                                    {person.email && <div className="flex items-center gap-1"><span className="text-gray-400"></span><span className="text-gray-600">{person.email}</span></div>}
                                                    {person.phone && <div className="flex items-center gap-1"><span className="text-gray-400"></span><span className="text-gray-600">{person.phone}</span></div>}
                                                    {person.usi && <div className="flex items-center gap-1"><span className="text-gray-400"></span><span className="text-gray-600">USI: {person.usi}</span></div>}
                                                    {person.dob && <div className="flex items-center gap-1"><span className="text-gray-400"></span><span className="text-gray-600">{new Date(person.dob).toLocaleDateString()}</span></div>}
                                                </div>
                                            </div>
                                            <div className="flex gap-1">
                                                <button onClick={() => { setEditingPerson(person); setPeopleModalOpen(true); }} className="text-blue-500 text-xs hover:underline">Edit</button>
                                                <button onClick={() => handleDeletePerson(person.id)} className="text-red-500 text-xs hover:underline">Delete</button>
                                            </div>
                                        </div>
                                        <button onClick={() => setSelectedPerson(person)} className="w-full mt-3 bg-blue-500 text-white px-3 py-2 rounded text-sm">View Training</button>
                                    </div>
                                ))}
                            </div>
                            
                            {filteredPeople.length === 0 && (
                                <div className="text-center py-8 text-gray-500">
                                    No staff members match your filters.
                                </div>
                            )}
                        </div>

                        {selectedPerson && (
                            <div className="bg-white rounded-lg shadow-lg p-6">
                                <div className="flex justify-between mb-4">
                                    <h2 className="text-xl font-bold">{selectedPerson.name} - Training Records</h2>
                                    <button onClick={() => setSelectedPerson(null)} className="text-gray-500">Close</button>
                                </div>
                                <div className="space-y-3">
                                    {competencies.filter(comp => requirements[comp.id]?.[selectedPerson.roleId]).map(comp => {
                                        const record = trainingRecords.find(r => r.personId === selectedPerson.id && r.competencyId === comp.id);
                                        const course = record ? courses.find(c => c.id === record.courseId) : null;
                                        const status = getTrainingStatus(record);
                                        return (
                                            <div key={comp.id} className="border rounded-lg p-4">
                                                <div className="flex justify-between">
                                                    <div>
                                                        <div className="flex items-center gap-2">
                                                            <h4 className="font-semibold text-sm">{comp.name}</h4>
                                                            {record?.recordFileUrl && (
                                                                <span className="text-green-600 text-xs" title="Certificate attached"></span>
                                                            )}
                                                        </div>
                                                        {record && course && (
                                                            <div className="mt-2 text-xs">
                                                                <p><strong>Course:</strong> {course.name}</p>
                                                                <p><strong>Completed:</strong> {record.completedDate}</p>
                                                                {record.expiryDate && <p><strong>Expires:</strong> {record.expiryDate}</p>}
                                                                {record.certificateNumber && <p><strong>Cert #:</strong> {record.certificateNumber}</p>}
                                                                {record.recordFileName && (
                                                                    <p className="flex items-center gap-1 text-green-600">
                                                                        <span></span>
                                                                        <span>{record.recordFileName}</span>
                                                                    </p>
                                                                )}
                                                                {record.cm10Link && (
                                                                    <p className="flex items-center gap-1">
                                                                        <span></span>
                                                                        <a href={record.cm10Link} target="_blank" rel="noopener noreferrer" className="text-blue-500 hover:underline">
                                                                            CM10 Record
                                                                        </a>
                                                                    </p>
                                                                )}
                                                            </div>
                                                        )}
                                                    </div>
                                                    <div className="flex flex-col gap-2">
                                                        {getStatusBadge(status)}
                                                        <button onClick={() => { setEditingRecord({ competency: comp, person: selectedPerson, record }); setTrainingRecordModalOpen(true); }} className="text-blue-500 text-xs">
                                                            {record ? 'Edit' : 'Add'}
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        )}
                    </div>
                )}

                {activeTab === 'reports' && (
                    <div className="space-y-6">
                        <div className="bg-white rounded-lg shadow-lg p-6">
                            <h2 className="text-xl font-bold mb-4">Training Reports</h2>
                            
                            {/* Report 1: Upcoming Training (Expiring within 90 days) */}
                            <div className="mb-6">
                                <h3 className="text-lg font-semibold mb-3 text-orange-600"> Training Expiring within 90 Days</h3>
                                {(() => {
                                    const today = new Date();
                                    const ninetyDaysFromNow = new Date(today.getTime() + (90 * 24 * 60 * 60 * 1000));
                                    const expiringRecords = trainingRecords.filter(record => {
                                        if (!record.expiryDate) return false;
                                        const expiry = new Date(record.expiryDate);
                                        return expiry > today && expiry <= ninetyDaysFromNow;
                                    }).map(record => ({
                                        ...record,
                                        person: people.find(p => p.id === record.personId),
                                        competency: competencies.find(c => c.id === record.competencyId),
                                        course: courses.find(c => c.id === record.courseId),
                                        daysUntilExpiry: Math.floor((new Date(record.expiryDate) - today) / (1000 * 60 * 60 * 24))
                                    })).sort((a, b) => a.daysUntilExpiry - b.daysUntilExpiry);

                                    if (expiringRecords.length === 0) {
                                        return <p className="text-gray-600 text-sm">No training expiring in the next 90 days.</p>;
                                    }

                                    return (
                                        <div className="overflow-x-auto">
                                            <table className="w-full border-collapse border text-sm">
                                                <thead className="bg-orange-50">
                                                    <tr>
                                                        <th className="border p-2 text-left">Person</th>
                                                        <th className="border p-2 text-left">Role</th>
                                                        <th className="border p-2 text-left">Competency</th>
                                                        <th className="border p-2 text-left">Course</th>
                                                        <th className="border p-2 text-left">Expiry Date</th>
                                                        <th className="border p-2 text-left">Days Until Expiry</th>
                                                        <th className="border p-2 text-left">Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {expiringRecords.map((record, idx) => (
                                                        <tr key={idx} className={idx % 2 === 0 ? 'bg-white' : 'bg-gray-50'}>
                                                            <td className="border p-2 font-medium">{record.person?.name}</td>
                                                            <td className="border p-2 text-gray-600">{roles.find(r => r.id === record.person?.roleId)?.name}</td>
                                                            <td className="border p-2">{record.competency?.name}</td>
                                                            <td className="border p-2 text-gray-600">{record.course?.name}</td>
                                                            <td className="border p-2">{record.expiryDate}</td>
                                                            <td className="border p-2">
                                                                <span className={`px-2 py-1 rounded text-xs font-semibold ${record.daysUntilExpiry <= 30 ? 'bg-red-500 text-white' : 'bg-orange-500 text-white'}`}>
                                                                    {record.daysUntilExpiry} days
                                                                </span>
                                                            </td>
                                                            <td className="border p-2">
                                                                {record.daysUntilExpiry <= 30 ? getStatusBadge('expiring') : <span className="px-2 py-1 rounded text-xs font-semibold bg-yellow-500 text-white">Due Soon</span>}
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                            </table>
                                            <p className="text-xs text-gray-600 mt-2">Total: {expiringRecords.length} training certifications expiring</p>
                                        </div>
                                    );
                                })()}
                            </div>

                            {/* Report 2: Expired Training */}
                            <div className="mb-6">
                                <h3 className="text-lg font-semibold mb-3 text-red-600"> Expired Training</h3>
                                {(() => {
                                    const today = new Date();
                                    const expiredRecords = trainingRecords.filter(record => {
                                        if (!record.expiryDate) return false;
                                        const expiry = new Date(record.expiryDate);
                                        return expiry < today;
                                    }).map(record => ({
                                        ...record,
                                        person: people.find(p => p.id === record.personId),
                                        competency: competencies.find(c => c.id === record.competencyId),
                                        course: courses.find(c => c.id === record.courseId),
                                        daysExpired: Math.floor((today - new Date(record.expiryDate)) / (1000 * 60 * 60 * 24))
                                    })).sort((a, b) => b.daysExpired - a.daysExpired);

                                    if (expiredRecords.length === 0) {
                                        return <p className="text-gray-600 text-sm">No expired training certifications.</p>;
                                    }

                                    return (
                                        <div className="overflow-x-auto">
                                            <table className="w-full border-collapse border text-sm">
                                                <thead className="bg-red-50">
                                                    <tr>
                                                        <th className="border p-2 text-left">Person</th>
                                                        <th className="border p-2 text-left">Role</th>
                                                        <th className="border p-2 text-left">Competency</th>
                                                        <th className="border p-2 text-left">Course</th>
                                                        <th className="border p-2 text-left">Expired Date</th>
                                                        <th className="border p-2 text-left">Days Expired</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {expiredRecords.map((record, idx) => (
                                                        <tr key={idx} className={idx % 2 === 0 ? 'bg-white' : 'bg-gray-50'}>
                                                            <td className="border p-2 font-medium">{record.person?.name}</td>
                                                            <td className="border p-2 text-gray-600">{roles.find(r => r.id === record.person?.roleId)?.name}</td>
                                                            <td className="border p-2">{record.competency?.name}</td>
                                                            <td className="border p-2 text-gray-600">{record.course?.name}</td>
                                                            <td className="border p-2">{record.expiryDate}</td>
                                                            <td className="border p-2">
                                                                <span className="px-2 py-1 rounded text-xs font-semibold bg-red-500 text-white">
                                                                    {record.daysExpired} days ago
                                                                </span>
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                            </table>
                                            <p className="text-xs text-gray-600 mt-2">Total: {expiredRecords.length} expired certifications</p>
                                        </div>
                                    );
                                })()}
                            </div>

                            {/* Report 3: Mandatory Training Not Complete */}
                            <div className="mb-6">
                                <h3 className="text-lg font-semibold mb-3 text-blue-600"> Mandatory Training Not Completed</h3>
                                {(() => {
                                    const incompleteRecords = [];
                                    people.forEach(person => {
                                        competencies.forEach(comp => {
                                            const requirement = requirements[comp.id]?.[person.roleId];
                                            // Check if it's mandatory (M(A), M(S), or LM)
                                            if (requirement && (requirement.startsWith('M') || requirement === 'LM')) {
                                                const record = trainingRecords.find(r => r.personId === person.id && r.competencyId === comp.id);
                                                if (!record) {
                                                    incompleteRecords.push({
                                                        person,
                                                        competency: comp,
                                                        requirement,
                                                        role: roles.find(r => r.id === person.roleId)
                                                    });
                                                }
                                            }
                                        });
                                    });

                                    // Sort by person name
                                    incompleteRecords.sort((a, b) => a.person.name.localeCompare(b.person.name));

                                    if (incompleteRecords.length === 0) {
                                        return <p className="text-gray-600 text-sm">All mandatory training completed! </p>;
                                    }

                                    return (
                                        <div className="overflow-x-auto">
                                            <table className="w-full border-collapse border text-sm">
                                                <thead className="bg-blue-50">
                                                    <tr>
                                                        <th className="border p-2 text-left">Person</th>
                                                        <th className="border p-2 text-left">Role</th>
                                                        <th className="border p-2 text-left">Department</th>
                                                        <th className="border p-2 text-left">Missing Competency</th>
                                                        <th className="border p-2 text-left">Category</th>
                                                        <th className="border p-2 text-left">Requirement Type</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {incompleteRecords.map((item, idx) => (
                                                        <tr key={idx} className={idx % 2 === 0 ? 'bg-white' : 'bg-gray-50'}>
                                                            <td className="border p-2 font-medium">{item.person.name}</td>
                                                            <td className="border p-2 text-gray-600">{item.role?.name}</td>
                                                            <td className="border p-2 text-gray-600">{item.person.department}</td>
                                                            <td className="border p-2">{item.competency.name}</td>
                                                            <td className="border p-2 text-gray-600">{item.competency.category}</td>
                                                            <td className="border p-2">
                                                                <span className={`px-2 py-1 rounded text-xs font-semibold ${item.requirement === 'LM' ? 'bg-orange-500 text-white' : 'bg-red-500 text-white'}`}>
                                                                    {item.requirement}
                                                                </span>
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                            </table>
                                            <p className="text-xs text-gray-600 mt-2">Total: {incompleteRecords.length} mandatory training items not completed</p>
                                        </div>
                                    );
                                })()}
                            </div>

                            {/* Summary Statistics */}
                            <div className="border-t pt-4">
                                <h3 className="text-lg font-semibold mb-3"> Summary Statistics</h3>
                                <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                                    <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                        <div className="text-2xl font-bold text-blue-600">{people.length}</div>
                                        <div className="text-sm text-gray-600">Total Staff</div>
                                    </div>
                                    <div className="bg-green-50 border border-green-200 rounded-lg p-4">
                                        <div className="text-2xl font-bold text-green-600">{trainingRecords.length}</div>
                                        <div className="text-sm text-gray-600">Training Records</div>
                                    </div>
                                    <div className="bg-orange-50 border border-orange-200 rounded-lg p-4">
                                        <div className="text-2xl font-bold text-orange-600">
                                            {trainingRecords.filter(r => {
                                                if (!r.expiryDate) return false;
                                                const days = Math.floor((new Date(r.expiryDate) - new Date()) / 86400000);
                                                return days > 0 && days <= 90;
                                            }).length}
                                        </div>
                                        <div className="text-sm text-gray-600">Expiring Soon</div>
                                    </div>
                                    <div className="bg-red-50 border border-red-200 rounded-lg p-4">
                                        <div className="text-2xl font-bold text-red-600">
                                            {(() => {
                                                let count = 0;
                                                people.forEach(person => {
                                                    competencies.forEach(comp => {
                                                        const req = requirements[comp.id]?.[person.roleId];
                                                        if (req && (req.startsWith('M') || req === 'LM')) {
                                                            const record = trainingRecords.find(r => r.personId === person.id && r.competencyId === comp.id);
                                                            if (!record) count++;
                                                        }
                                                    });
                                                });
                                                return count;
                                            })()}
                                        </div>
                                        <div className="text-sm text-gray-600">Mandatory Missing</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                )}
            </div>

            <RequirementModal isOpen={requirementModalOpen} onClose={() => setRequirementModalOpen(false)} onSave={handleSaveRequirement} competency={editingRequirement?.competency} role={editingRequirement?.role} currentRequirement={editingRequirement?.currentRequirement} />
            <CourseModal isOpen={courseModalOpen} onClose={() => { setCourseModalOpen(false); setEditingCourse(null); }} onSave={handleSaveCourse} existingCourse={editingCourse} competencies={competencies} />
            <TrainingRecordModal isOpen={trainingRecordModalOpen} onClose={() => { setTrainingRecordModalOpen(false); setEditingRecord(null); }} onSave={handleSaveTrainingRecord} person={editingRecord?.person} competency={editingRecord?.competency} existingRecord={editingRecord?.record} courses={courses} />
            <PeopleModal isOpen={peopleModalOpen} onClose={() => { setPeopleModalOpen(false); setEditingPerson(null); }} onSave={handleSavePerson} existingPerson={editingPerson} roles={roles} />
            <CSVUploadModal isOpen={csvUploadModalOpen} onClose={() => setCsvUploadModalOpen(false)} onUpload={handleCSVUpload} roles={roles} />
            <CompetencyEditorModal isOpen={competencyEditorModalOpen} onClose={() => { setCompetencyEditorModalOpen(false); setEditingCompetency(null); }} onSave={handleSaveCompetency} existingCompetency={editingCompetency} roles={roles} onApplyToRoles={handleApplyCompetencyToRoles} courses={courses} />
        </div>
    );
}

ReactDOM.render(<TrainingManagementSystem />, document.getElementById('root'));
    </script>
</body>
</html>
